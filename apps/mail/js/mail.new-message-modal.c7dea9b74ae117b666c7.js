/*! For license information please see mail.new-message-modal.c7dea9b74ae117b666c7.js.LICENSE.txt */
"use strict";(self.webpackChunknextcloud_mail=self.webpackChunknextcloud_mail||[]).push([[315],{96187:function(t,e,n){var r=n(87537),o=n.n(r),i=n(23645),a=n.n(i)()(o());a.push([t.id,'.message-composer[data-v-375dc1a6]{margin:0;z-index:100;display:flex;flex-direction:column;height:100%;max-height:100%}.composer-actions[data-v-375dc1a6]{position:sticky;background:linear-gradient(rgba(255, 255, 255, 0), var(--color-main-background-translucent) 50%)}.composer-fields[data-v-375dc1a6]{display:flex;border-top:1px solid var(--color-border);align-items:flex-start}.composer-fields label[data-v-375dc1a6]{padding:11px 20px 11px 0}.composer-fields[data-v-375dc1a6] .multiselect--multiple .multiselect__tags{display:grid;grid-template-columns:calc(100% - 18px) 18px 100%}.composer-fields[data-v-375dc1a6] .multiselect--multiple .multiselect__tags .multiselect__limit{margin-right:0;margin-left:8px}.composer-fields[data-v-375dc1a6] .multiselect__content-wrapper{border-bottom:1px solid var(--color-border);margin-top:0}.composer-fields[data-v-375dc1a6] .multiselect__content-wrapper li>span::before{display:none}.composer-fields[data-v-375dc1a6] .multiselect__input{position:relative !important;top:0;grid-column-start:1;grid-column-end:3}.composer-fields[data-v-375dc1a6] .multiselect--active input:focus-visible{box-shadow:none}.composer-fields[data-v-375dc1a6] .multiselect__tags{box-sizing:border-box;height:auto}.composer-fields__from[data-v-375dc1a6]{margin-right:102px}.composer-fields .multiselect.multiselect--multiple[data-v-375dc1a6]::after{position:absolute;right:0;top:auto;bottom:8px}.composer-fields .multiselect__tag[data-v-375dc1a6]{position:relative}.composer-fields.mail-account[data-v-375dc1a6]{border-top:none;padding-top:10px}.composer-fields.mail-account>.multiselect[data-v-375dc1a6]{max-width:none;min-height:auto}.composer-fields .multiselect[data-v-375dc1a6],.composer-fields input[data-v-375dc1a6],.composer-fields TextEditor[data-v-375dc1a6]{flex-grow:1;max-width:none;border:none;border-radius:0}.composer-fields .composer-fields--custom[data-v-375dc1a6]{display:flex;align-items:flex-start;flex-wrap:wrap;padding-top:2px;width:calc(100% - 120px)}.composer-fields .composer-fields--custom button[data-v-375dc1a6]{margin-top:0;margin-bottom:0;background-color:rgba(0,0,0,0);border:none;opacity:.5;padding:10px 16px}.composer-fields .composer-fields--custom button.active[data-v-375dc1a6],.composer-fields .composer-fields--custom button[data-v-375dc1a6]:active{opacity:1}.composer-fields .composer-fields--custom .multiselect[data-v-375dc1a6]{width:calc(100% - 150px)}.composer-fields .multiselect[data-v-375dc1a6]{margin-right:12px}.composer-fields .subject[data-v-375dc1a6]{font-size:15px;font-weight:bold;margin:3px 0 !important;padding:0 12px !important}.composer-fields .subject[data-v-375dc1a6]:focus-visible{box-shadow:none !important}.composer-fields .message-body[data-v-375dc1a6]{height:100%;width:100%;margin:0;border:none !important;outline:none !important;box-shadow:none !important;padding:12px;-webkit-user-select:text;user-select:text}.message-editor[data-v-375dc1a6]{flex:1 1 100%;min-height:0}.draft-status[data-v-375dc1a6]{padding:2px;opacity:.5;font-size:small;display:block}.from-label[data-v-375dc1a6],.to-label[data-v-375dc1a6],.copy-toggle[data-v-375dc1a6],.cc-label[data-v-375dc1a6],.bcc-label[data-v-375dc1a6]{padding-top:12px;padding-bottom:12px;padding-right:20px;cursor:text;color:var(--color-text-maxcontrast);width:100px;text-align:right;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold}.bcc-label[data-v-375dc1a6]{top:initial;bottom:0}.copy-toggle[data-v-375dc1a6]{cursor:pointer;width:initial}.copy-toggle[data-v-375dc1a6]:hover,.copy-toggle[data-v-375dc1a6]:focus{color:var(--color-main-text)}.reply[data-v-375dc1a6]{min-height:100px}[data-v-375dc1a6] .multiselect .multiselect__tags,.subject[data-v-375dc1a6]{border:none !important}[data-v-375dc1a6] [data-select="create"] .avatardiv--unknown{background:var(--color-text-maxcontrast) !important}[data-v-375dc1a6] .multiselect.opened .multiselect__tags .multiselect__tags-wrap{flex-wrap:wrap}.submit-message.send.primary.icon-confirm-white[data-v-375dc1a6]{color:var(--color-main-background)}.button[data-v-375dc1a6]{background-color:rgba(0,0,0,0);border:none}.send-button[data-v-375dc1a6]{display:flex;align-items:center;padding:10px 15px;margin-left:5px}.send-button .send-icon[data-v-375dc1a6]{padding-right:5px}.centered-content[data-v-375dc1a6]{margin-top:0 !important}.composer-actions-right[data-v-375dc1a6]{display:flex;align-items:center;flex-direction:row;justify-content:space-between;bottom:5px}.composer-actions--primary-actions[data-v-375dc1a6]{display:flex;flex-direction:row;padding-left:10px;align-items:center}.composer-actions--secondary-actions[data-v-375dc1a6]{display:flex;flex-direction:row;padding:12px;gap:5px}.composer-actions--primary-actions .button[data-v-375dc1a6]{padding:2px}.composer-actions--secondary-actions .button[data-v-375dc1a6]{flex-shrink:0}.composer-actions-draft-status[data-v-375dc1a6]{padding-left:10px}@media only screen and (max-width: 580px){.composer-actions-right[data-v-375dc1a6]{align-items:end;flex-direction:column-reverse}.composer-actions-draft-status[data-v-375dc1a6]{text-align:end;padding-right:15px}.composer-actions--primary-actions[data-v-375dc1a6]{padding-right:5px}}',"",{version:3,sources:["webpack://./src/components/Composer.vue"],names:[],mappings:"AACA,mCACC,QAAA,CACA,WAAA,CACA,YAAA,CACA,qBAAA,CACA,WAAA,CACA,eAAA,CAGD,mCACC,eAAA,CACA,gGAAA,CAGD,kCACC,YAAA,CACA,wCAAA,CACA,sBAAA,CAEA,wCACC,wBAAA,CAGD,4EACC,YAAA,CACA,iDAAA,CAEA,gGACC,cAAA,CACA,eAAA,CAIF,gEACC,2CAAA,CACA,YAAA,CAEA,gFACC,YAAA,CAIF,sDACC,4BAAA,CACA,KAAA,CACA,mBAAA,CACA,iBAAA,CAGD,2EACC,eAAA,CAGD,qDACC,qBAAA,CACA,WAAA,CAGD,wCACC,kBAAA,CAGD,4EACC,iBAAA,CACA,OAAA,CACA,QAAA,CACA,UAAA,CAGD,oDACC,iBAAA,CAGD,+CACC,eAAA,CACA,gBAAA,CAEA,4DACC,cAAA,CACA,eAAA,CAIF,oIAGC,WAAA,CACA,cAAA,CACA,WAAA,CACA,eAAA,CAGD,2DACC,YAAA,CACA,sBAAA,CACA,cAAA,CACA,eAAA,CACA,wBAAA,CAEA,kEACC,YAAA,CACA,eAAA,CACA,8BAAA,CACA,WAAA,CACA,UAAA,CACA,iBAAA,CAGD,kJACC,SAAA,CAGD,wEACC,wBAAA,CAIF,+CACC,iBAAA,CAGD,2CACC,cAAA,CACA,gBAAA,CACA,uBAAA,CACA,yBAAA,CAEA,yDACC,0BAAA,CAIF,gDACC,WAAA,CACA,UAAA,CACA,QAAA,CACA,sBAAA,CACA,uBAAA,CACA,0BAAA,CACA,YAAA,CAIA,wBAAA,CACA,gBAAA,CAKF,iCACC,aAAA,CACA,YAAA,CAGD,+BACC,WAAA,CACA,UAAA,CACA,eAAA,CACA,aAAA,CAGD,6IAKC,gBAAA,CACA,mBAAA,CACA,kBAAA,CACA,WAAA,CACA,mCAAA,CACA,WAAA,CACA,gBAAA,CACA,kBAAA,CACA,eAAA,CACA,sBAAA,CACA,gBAAA,CAGD,4BACC,WAAA,CACA,QAAA,CAGD,8BACC,cAAA,CACA,aAAA,CAEA,wEAEC,4BAAA,CAIF,wBACC,gBAAA,CAGD,4EACC,sBAAA,CAED,6DACC,mDAAA,CAED,iFACC,cAAA,CAGD,iEACC,kCAAA,CAED,yBACC,8BAAA,CACA,WAAA,CAED,8BACC,YAAA,CACA,kBAAA,CACA,iBAAA,CACA,eAAA,CAED,yCACC,iBAAA,CAED,mCACC,uBAAA,CAED,yCACC,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,6BAAA,CACA,UAAA,CAED,oDACC,YAAA,CACA,kBAAA,CACA,iBAAA,CACA,kBAAA,CAED,sDACC,YAAA,CACA,kBAAA,CACA,YAAA,CACA,OAAA,CAED,4DACC,WAAA,CAED,8DACC,aAAA,CAGD,gDACC,iBAAA,CAGD,0CACC,yCACC,eAAA,CACA,6BAAA,CAED,gDACC,cAAA,CACA,kBAAA,CAED,oDACC,iBAAA,CAAA",sourcesContent:['\n.message-composer {\n\tmargin: 0;\n\tz-index: 100;\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 100%;\n\tmax-height: 100%;\n}\n\n.composer-actions {\n\tposition: sticky;\n\tbackground: linear-gradient(rgba(255, 255, 255, 0), var(--color-main-background-translucent) 50%);\n}\n\n.composer-fields {\n\tdisplay: flex;\n\tborder-top: 1px solid var(--color-border);\n\talign-items: flex-start;\n\n\tlabel {\n\t\tpadding: 11px 20px 11px 0;\n\t}\n\n\t:deep(.multiselect--multiple .multiselect__tags) {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: calc(100% - 18px) 18px 100%;\n\n\t\t.multiselect__limit {\n\t\t\tmargin-right: 0;\n\t\t\tmargin-left: 8px\n\t\t}\n\t}\n\n\t:deep(.multiselect__content-wrapper) {\n\t\tborder-bottom: 1px solid var(--color-border);\n\t\tmargin-top: 0;\n\n\t\t& li > span::before {\n\t\t\tdisplay: none\n\t\t}\n\t}\n\n\t:deep(.multiselect__input) {\n\t\tposition: relative !important;\n\t\ttop: 0;\n\t\tgrid-column-start: 1;\n\t\tgrid-column-end: 3;\n\t}\n\n\t:deep(.multiselect--active input:focus-visible) {\n\t\tbox-shadow: none;\n\t}\n\n\t:deep(.multiselect__tags) {\n\t\tbox-sizing: border-box;\n\t\theight: auto;\n\t}\n\n\t&__from {\n\t\tmargin-right: 102px; /* for the modal close and minimize buttons */\n\t}\n\n\t.multiselect.multiselect--multiple::after {\n\t\tposition: absolute;\n\t\tright: 0;\n\t\ttop: auto;\n\t\tbottom: 8px\n\t}\n\n\t.multiselect__tag {\n\t\tposition: relative;\n\t}\n\n\t&.mail-account {\n\t\tborder-top: none;\n\t\tpadding-top: 10px;\n\n\t\t& > .multiselect {\n\t\t\tmax-width: none;\n\t\t\tmin-height: auto;\n\t\t}\n\t}\n\n\t.multiselect,\n\tinput,\n\tTextEditor {\n\t\tflex-grow: 1;\n\t\tmax-width: none;\n\t\tborder: none;\n\t\tborder-radius: 0;\n\t}\n\n\t.composer-fields--custom {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tflex-wrap: wrap;\n\t\tpadding-top: 2px;\n\t\twidth: calc(100% - 120px);\n\n\t\tbutton {\n\t\t\tmargin-top: 0;\n\t\t\tmargin-bottom: 0;\n\t\t\tbackground-color: transparent;\n\t\t\tborder: none;\n\t\t\topacity: 0.5;\n\t\t\tpadding: 10px 16px;\n\t\t}\n\n\t\tbutton.active, button:active {\n\t\t\topacity: 1;\n\t\t}\n\n\t\t.multiselect {\n\t\t\twidth: calc(100% - 150px);\n\t\t}\n\t}\n\n\t.multiselect {\n\t\tmargin-right: 12px;\n\t}\n\n\t.subject {\n\t\tfont-size: 15px;\n\t\tfont-weight: bold;\n\t\tmargin: 3px 0 !important;\n\t\tpadding: 0 12px !important;\n\n\t\t&:focus-visible {\n\t\t\tbox-shadow: none !important;\n\t\t}\n\t}\n\n\t.message-body {\n\t\theight: 100%;\n\t\twidth: 100%;\n\t\tmargin: 0;\n\t\tborder: none !important;\n\t\toutline: none !important;\n\t\tbox-shadow: none !important;\n\t\tpadding: 12px;\n\n\t\t// Fix contenteditable not becoming focused upon clichint within it\'s\n\t\t// boundaries in safari\n\t\t-webkit-user-select: text;\n\t\tuser-select: text;\n\t}\n}\n\n// Make composer editor expand\n.message-editor {\n\tflex: 1 1 100%;\n\tmin-height: 0;\n}\n\n.draft-status {\n\tpadding: 2px;\n\topacity: 0.5;\n\tfont-size: small;\n\tdisplay: block;\n}\n\n.from-label,\n.to-label,\n.copy-toggle,\n.cc-label,\n.bcc-label {\n\tpadding-top: 12px;\n\tpadding-bottom: 12px;\n\tpadding-right: 20px;\n\tcursor: text;\n\tcolor: var(--color-text-maxcontrast);\n\twidth: 100px;\n\ttext-align: right;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\tfont-weight: bold;\n}\n\n.bcc-label {\n\ttop: initial;\n\tbottom: 0;\n}\n\n.copy-toggle {\n\tcursor: pointer;\n\twidth: initial;\n\n\t&:hover,\n\t&:focus {\n\t\tcolor: var(--color-main-text);\n\t}\n}\n\n.reply {\n\tmin-height: 100px;\n}\n\n:deep(.multiselect .multiselect__tags), .subject {\n\tborder: none !important;\n}\n:deep([data-select="create"] .avatardiv--unknown) {\n\tbackground: var(--color-text-maxcontrast) !important;\n}\n:deep(.multiselect.opened .multiselect__tags .multiselect__tags-wrap) {\n\tflex-wrap: wrap;\n}\n\n.submit-message.send.primary.icon-confirm-white {\n\tcolor: var(--color-main-background);\n}\n.button {\n\tbackground-color: transparent;\n\tborder: none;\n}\n.send-button {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 10px 15px;\n\tmargin-left: 5px;\n}\n.send-button .send-icon {\n\tpadding-right: 5px;\n}\n.centered-content {\n\tmargin-top: 0 !important;\n}\n.composer-actions-right {\n\tdisplay: flex;\n\talign-items: center;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\tbottom: 5px;\n}\n.composer-actions--primary-actions {\n\tdisplay: flex;\n\tflex-direction: row;\n\tpadding-left: 10px;\n\talign-items: center;\n}\n.composer-actions--secondary-actions {\n\tdisplay: flex;\n\tflex-direction: row;\n\tpadding: 12px;\n\tgap: 5px;\n}\n.composer-actions--primary-actions .button {\n\tpadding: 2px;\n}\n.composer-actions--secondary-actions .button{\n\tflex-shrink: 0;\n}\n\n.composer-actions-draft-status {\n\tpadding-left: 10px;\n}\n\n@media only screen and (max-width: 580px) {\n\t.composer-actions-right {\n\t\talign-items: end;\n\t\tflex-direction: column-reverse;\n\t}\n\t.composer-actions-draft-status {\n\t\ttext-align: end;\n\t\tpadding-right: 15px;\n\t}\n\t.composer-actions--primary-actions {\n\t\tpadding-right: 5px;\n\t}\n}\n\n'],sourceRoot:""}]),e.Z=a},33706:function(t,e,n){var r=n(87537),o=n.n(r),i=n(23645),a=n.n(i)()(o());a.push([t.id,".composer-attachment[data-v-47464ade]{width:calc(50% - 20px);box-sizing:border-box;display:flex;justify-content:space-between;align-items:flex-start;margin:10px;flex-wrap:wrap}.composer-attachment--with-error[data-v-47464ade]{color:red;opacity:.5}.composer-attachment .cloud-attachment-icon[data-v-47464ade]{position:absolute;z-index:2;right:2px;top:2px;color:#000}.composer-attachment .attachment-preview[data-v-47464ade]{display:inline-flex;flex-wrap:wrap;width:50px;height:50px;overflow:hidden;border-radius:3px;align-items:center;justify-content:center;position:relative}.composer-attachment .attachment-preview img[data-v-47464ade]{display:block;min-width:50px;min-height:50px;max-width:72px;max-height:72px;position:absolute}.composer-attachment .attachment-preview span[data-v-47464ade]{color:rgba(0,0,0,.3);font-size:13px;text-transform:uppercase;font-weight:bold}.composer-attachment button[data-v-47464ade]{padding:0;background:rgba(0,0,0,0);border:none;margin:6px -2px 0 0}.attachments-upload-progress[data-v-47464ade]{display:block;height:5px;width:100%;position:relative;border-radius:5px;background:var(--color-background-dark);margin-top:7px}.attachments-upload-progress .attachments-upload-progress--bar[data-v-47464ade]{height:5px;background:var(--color-primary-element-light);position:absolute;z-index:1;left:0;border-radius:5px}.attachments-upload-progress>div[data-v-47464ade]{padding-left:3px}.new-message-attachments-action[data-v-47464ade]{display:inline-block;vertical-align:middle;padding:18px;opacity:.5}.attachment-inner[data-v-47464ade]{display:flex;flex-wrap:wrap;width:calc(100% - 90px);position:relative}.new-message-attachment-name[data-v-47464ade]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;margin-bottom:3px}.new-message-attachment-size[data-v-47464ade]{color:#6a6a6a;width:100%}.new-message-attachment-name.upload-ongoing[data-v-47464ade]{color:#0082c9}.new-message-attachment-name.upload-warning[data-v-47464ade]{color:#d2322d}.new-message-attachment-name.upload-warning .ui-progressbar-value[data-v-47464ade]{border:1px solid #e9322d;background:#e9322d}","",{version:3,sources:["webpack://./src/components/ComposerAttachment.vue"],names:[],mappings:"AAEA,sCACC,sBAAA,CACG,qBAAA,CACA,YAAA,CACA,6BAAA,CACA,sBAAA,CACA,WAAA,CACA,cAAA,CAEH,kDACC,SAAA,CACA,UAAA,CAGD,6DACC,iBAAA,CACA,SAAA,CACA,SAAA,CACA,OAAA,CACA,UAAA,CAGD,0DACC,mBAAA,CACA,cAAA,CACA,UAAA,CACA,WAAA,CACA,eAAA,CACA,iBAAA,CACA,kBAAA,CACA,sBAAA,CACA,iBAAA,CAEA,8DACC,aAAA,CACA,cAAA,CACA,eAAA,CACA,cAAA,CACA,eAAA,CACA,iBAAA,CAGD,+DACC,oBAAA,CACA,cAAA,CACA,wBAAA,CACA,gBAAA,CAKF,6CACC,SAAA,CACA,wBAAA,CACA,WAAA,CACA,mBAAA,CAIF,8CACC,aAAA,CACA,UAAA,CACA,UAAA,CACA,iBAAA,CACA,iBAAA,CACA,uCAAA,CACA,cAAA,CAEA,gFACC,UAAA,CACA,6CAAA,CACA,iBAAA,CACA,SAAA,CACA,MAAA,CACA,iBAAA,CAIF,kDACC,gBAAA,CAGD,iDACC,oBAAA,CACA,qBAAA,CACA,YAAA,CACA,UAAA,CAGD,mCACC,YAAA,CACG,cAAA,CACH,uBAAA,CACA,iBAAA,CAKD,8CACC,sBAAA,CACA,eAAA,CACA,kBAAA,CACA,iBAAA,CAGD,8CACC,aAAA,CACA,UAAA,CAID,6DACC,aAAA,CAID,6DACC,aAAA,CAID,mFACC,wBAAA,CACA,kBAAA",sourcesContent:["\n\n.composer-attachment {\n\twidth: calc(50% - 20px);\n    box-sizing: border-box;\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin: 10px;\n    flex-wrap: wrap;\n\n\t&--with-error {\n\t\tcolor:red;\n\t\topacity: 0.5;\n\t}\n\n\t.cloud-attachment-icon {\n\t\tposition:absolute;\n\t\tz-index: 2;\n\t\tright: 2px;\n\t\ttop: 2px;\n\t\tcolor: rgba(0, 0, 0, 1);\n\t}\n\n\t.attachment-preview {\n\t\tdisplay: inline-flex;\n\t\tflex-wrap: wrap;\n\t\twidth: 50px;\n\t\theight:50px;\n\t\toverflow: hidden;\n\t\tborder-radius: 3px;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tposition: relative;\n\n\t\timg {\n\t\t\tdisplay: block;\n\t\t\tmin-width: 50px;\n\t\t\tmin-height: 50px;\n\t\t\tmax-width: 72px;\n\t\t\tmax-height: 72px;\n\t\t\tposition: absolute;\n\t\t}\n\n\t\tspan {\n\t\t\tcolor: rgba(0,0,0,0.3);\n\t\t\tfont-size: 13px;\n\t\t\ttext-transform: uppercase;\n\t\t\tfont-weight: bold;\n\t\t}\n\n\t}\n\n\tbutton {\n\t\tpadding: 0;\n\t\tbackground: transparent;\n\t\tborder: none;\n\t\tmargin: 6px -2px 0 0;\n\t}\n}\n\n.attachments-upload-progress {\n\tdisplay: block;\n\theight: 5px;\n\twidth: 100%;\n\tposition: relative;\n\tborder-radius: 5px;\n\tbackground: var(--color-background-dark);\n\tmargin-top: 7px;\n\n\t.attachments-upload-progress--bar {\n\t\theight: 5px;\n\t\tbackground: var(--color-primary-element-light);\n\t\tposition: absolute;\n\t\tz-index: 1;\n\t\tleft: 0;\n\t\tborder-radius: 5px;\n\t}\n}\n\n.attachments-upload-progress > div {\n\tpadding-left: 3px;\n}\n\n.new-message-attachments-action {\n\tdisplay: inline-block;\n\tvertical-align: middle;\n\tpadding: 18px;\n\topacity: 0.5;\n}\n\n.attachment-inner {\n\tdisplay: flex;\n    flex-wrap: wrap;\n\twidth: calc(100% - 90px);\n\tposition: relative;\n\n}\n\n/* attachment filenames */\n.new-message-attachment-name {\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n\twhite-space:nowrap;\n\tmargin-bottom: 3px;\n}\n\n.new-message-attachment-size {\n\tcolor: #6a6a6a;\n\twidth: 100%;\n}\n\n/* Colour the filename with a different color during attachment upload */\n.new-message-attachment-name.upload-ongoing {\n\tcolor: #0082c9;\n}\n\n/* Colour the filename in red if the attachment upload failed */\n.new-message-attachment-name.upload-warning {\n\tcolor: #d2322d;\n}\n\n/* Red ProgressBar for failed attachment uploads */\n.new-message-attachment-name.upload-warning .ui-progressbar-value {\n\tborder: 1px solid #e9322d;\n\tbackground: #e9322d;\n}\n"],sourceRoot:""}]),e.Z=a},5070:function(t,e,n){var r=n(87537),o=n.n(r),i=n(23645),a=n.n(i)()(o());a.push([t.id,".new-message-attachments--counter[data-v-7f752cca]{color:var(--color-text-maxcontrast);padding:10px 20px;cursor:pointer;display:flex;align-items:center}.new-message-attachments--counter--with-errors[data-v-7f752cca]{color:red}.new-message-attachments--list[data-v-7f752cca]{display:flex;flex-wrap:wrap;overflow:auto;transition:max-height .5s cubic-bezier(0, 1, 0, 1);padding:0 10px}.new-message-attachments--list.hide[data-v-7f752cca]{overflow:hidden;max-height:0;transition:max-height .5s cubic-bezier(0, 1, 0, 1)}.new-message-attachments--list.active[data-v-7f752cca]{overflow:auto;max-height:287px}","",{version:3,sources:["webpack://./src/components/ComposerAttachments.vue"],names:[],mappings:"AAGC,mDACC,mCAAA,CACA,iBAAA,CACA,cAAA,CACA,YAAA,CACA,kBAAA,CAEA,gEACC,SAAA,CAIF,gDACC,YAAA,CACA,cAAA,CAEA,aAAA,CACA,kDAAA,CACA,cAAA,CAEA,qDACC,eAAA,CACA,YAAA,CACA,kDAAA,CAGD,uDACC,aAAA,CACA,gBAAA",sourcesContent:["\n\n.new-message-attachments {\n\t&--counter {\n\t\tcolor: var(--color-text-maxcontrast);\n\t\tpadding: 10px 20px;\n\t\tcursor:pointer;\n\t\tdisplay:flex;\n\t\talign-items: center;\n\n\t\t&--with-errors {\n\t\t\tcolor:red;\n\t\t}\n\t}\n\n\t&--list {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\t// 2 and a half attachment height\n\t\toverflow: auto;\n\t\ttransition: max-height 0.5s cubic-bezier(0, 1, 0, 1);\n\t\tpadding: 0 10px;\n\n\t\t&.hide {\n\t\t\toverflow: hidden;\n\t\t\tmax-height:0;\n\t\t\ttransition: max-height 0.5s cubic-bezier(0, 1, 0, 1);\n\t\t}\n\n\t\t&.active {\n\t\t\toverflow: auto;\n\t\t\tmax-height: 287px;\n\t\t}\n\t}\n}\n"],sourceRoot:""}]),e.Z=a},25209:function(t,e,n){var r=n(87537),o=n.n(r),i=n(23645),a=n.n(i)()(o());a.push([t.id,"@media only screen and (max-width: 600px){[data-v-44e14e2b] .modal-container{max-width:80%}}[data-v-44e14e2b] .modal-wrapper .modal-container{overflow-y:auto !important;overflow-x:auto !important;height:90%;max-height:700px !important}.minimize-button[data-v-44e14e2b]{position:absolute;right:49px;top:4px}","",{version:3,sources:["webpack://./src/components/NewMessageModal.vue"],names:[],mappings:"AACA,0CACC,mCACC,aAAA,CAAA,CAGF,kDACC,0BAAA,CACA,0BAAA,CAEA,UAAA,CAEA,2BAAA,CAGD,kCACC,iBAAA,CACA,UAAA,CACA,OAAA",sourcesContent:["\n@media only screen and (max-width: 600px) {\n\t:deep(.modal-container) {\n\t\tmax-width: 80%;\n\t}\n}\n:deep(.modal-wrapper .modal-container) {\n\toverflow-y: auto !important;\n\toverflow-x: auto !important;\n\t// from original Modal max-height\n\theight: 90%;\n\t// Max editor + modal height\n\tmax-height: 700px !important;\n}\n\n.minimize-button {\n\tposition: absolute;\n\tright: 49px;\n\ttop: 4px;\n}\n"],sourceRoot:""}]),e.Z=a},66515:function(t,e,n){var r=n(87537),o=n.n(r),i=n(23645),a=n.n(i)()(o());a.push([t.id,".multiselect .multiselect__tags .multiselect__tags-wrap .multiselect__tag--recipient[data-v-7614adf2]{padding:0;border-radius:25px;border-color:rgba(0,0,0,0);background-color:var(--color-background-dark);height:24px}.multiselect .multiselect__tags .multiselect__tags-wrap .multiselect__tag--recipient>span.option[data-v-7614adf2]{margin-left:0}.multiselect__tag--recipient .action-item--single[data-v-7614adf2]{width:auto;min-width:24px;height:24px;position:absolute;right:-7px}.multiselect__tag--recipient .action-item--single .material-design-icon[data-v-7614adf2]{height:24px;width:24px}.delete-recipient[data-v-7614adf2]{display:inline-flex;align-items:center;justify-content:center;cursor:pointer;height:24px;width:24px;min-width:24px;margin-left:6px;border-radius:50%}.delete-recipient[data-v-7614adf2]:hover{background:var(--color-background-darker)}[data-v-7614adf2] .option{margin-left:10px}","",{version:3,sources:["webpack://./src/components/RecipientListItem.vue"],names:[],mappings:"AACA,sGAIC,SAAA,CACA,kBAAA,CACA,0BAAA,CACA,6CAAA,CACA,WAAA,CAEA,kHACC,aAAA,CAGF,mEACC,UAAA,CACA,cAAA,CACA,WAAA,CACA,iBAAA,CACA,UAAA,CAED,yFACC,WAAA,CACA,UAAA,CAED,mCACC,mBAAA,CACA,kBAAA,CACA,sBAAA,CACA,cAAA,CACA,WAAA,CACA,UAAA,CACA,cAAA,CACA,eAAA,CACA,iBAAA,CAEA,yCACC,yCAAA,CAGF,0BACC,gBAAA",sourcesContent:["\n.multiselect\n\t.multiselect__tags\n\t.multiselect__tags-wrap\n\t.multiselect__tag--recipient {\n\tpadding: 0;\n\tborder-radius: 25px;\n\tborder-color: transparent;\n\tbackground-color: var(--color-background-dark);\n\theight: 24px;\n\n\t& > span.option {\n\t\tmargin-left: 0\n\t}\n}\n.multiselect__tag--recipient .action-item--single {\n\twidth: auto;\n\tmin-width: 24px;\n\theight: 24px;\n\tposition: absolute;\n\tright: -7px;\n}\n.multiselect__tag--recipient .action-item--single .material-design-icon {\n\theight: 24px;\n\twidth: 24px;\n}\n.delete-recipient {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: center;\n\tcursor: pointer;\n\theight: 24px;\n\twidth: 24px;\n\tmin-width: 24px;\n\tmargin-left: 6px;\n\tborder-radius: 50%;\n\n\t&:hover {\n\t\tbackground: var(--color-background-darker);\n\t}\n}\n:deep(.option) {\n\tmargin-left: 10px;\n}\n"],sourceRoot:""}]),e.Z=a},30980:function(t,e,n){var r=n(87537),o=n.n(r),i=n(23645),a=n.n(i)()(o());a.push([t.id,"\n#mailvelope-composer[data-v-0be7aff6] {\n\twidth: 100%;\n\theight: 450px;\n}\n","",{version:3,sources:["webpack://./src/components/MailvelopeEditor.vue"],names:[],mappings:";AA6EA;CACA,WAAA;CACA,aAAA;AACA",sourcesContent:["\x3c!--\n  - @copyright 2020 Christoph Wurst <christoph@winzerhof-wurst.at>\n  -\n  - @author 2020 Christoph Wurst <christoph@winzerhof-wurst.at>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program.  If not, see <http://www.gnu.org/licenses/>.\n  --\x3e\n\n<template>\n\t<div id=\"mailvelope-composer\" />\n</template>\n\n<script>\nimport logger from '../logger'\nimport { isPgpgMessage } from '../crypto/pgp'\n\nexport default {\n\tname: 'MailvelopeEditor',\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\trecipients: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tquotedText: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => undefined,\n\t\t},\n\t\tisReplyOrForward: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\teditor: undefined,\n\t\t}\n\t},\n\tasync mounted() {\n\t\tconst isEncrypted = this.quotedText ? isPgpgMessage(this.quotedText) : false\n\t\tconst quotedMail = this.isReplyOrForward ? this.quotedText?.value : undefined\n\n\t\tthis.editor = await window.mailvelope.createEditorContainer('#mailvelope-composer', undefined, {\n\t\t\tquotedMail: isEncrypted ? quotedMail : undefined,\n\t\t})\n\t},\n\tmethods: {\n\t\tasync pull() {\n\t\t\tconst recipients = this.recipients.map((r) => r.email)\n\t\t\tlogger.info('encrypting message', { recipients })\n\t\t\tconst armored = await this.editor.encrypt(recipients)\n\t\t\tlogger.info('message encryted', { armored })\n\n\t\t\tthis.$emit('input', armored)\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n#mailvelope-composer {\n\twidth: 100%;\n\theight: 450px;\n}\n</style>\n"],sourceRoot:""}]),e.Z=a},64344:function(e,n,r){r.r(n),r.d(n,{default:function(){return Oe}});var o=r(15961),i=r(64024),a=r(31352),s=r(89177),c=r(61189),l=r(76810),u=r.n(l),d=r(83049),p=r.n(d),h=r(21711),f=r.n(h),m=r(45668),A=r.n(m),v=r(59197),g=r(69496),y=r.n(g),C=r(32964),b=r(76188),w=r(88846),x=r.n(w),_=r(77958),k=r(3378),S=r(76059),L=r.n(S),E=r(37667),D=r.n(E),I=r(20144),B=r(85757);function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function T(){T=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),s=new k(o||[]);return r(a,"_invoke",{value:b(t,n,s)}),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function h(){}function f(){}var m={};c(m,i,(function(){return this}));var A=Object.getPrototypeOf,v=A&&A(A(S([])));v&&v!==e&&n.call(v,i)&&(m=v);var g=f.prototype=p.prototype=Object.create(m);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function o(r,i,a,s){var c=u(t[r],t,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==M(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,s)}))}s(c.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=u(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=f,r(g,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(C.prototype),c(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function O(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function j(t){return P.apply(this,arguments)}function P(){return(t=T().mark((function t(e){var n,r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,B.s)("files").stat(e,{data:'<?xml version="1.0"?>\n\t\t\t<d:propfind\n\t\t\txmlns:d="DAV:"\n\t\t\txmlns:oc="http://owncloud.org/ns"\n\t\t\txmlns:nc="http://nextcloud.org/ns">\n\t\t\t\t<d:prop>\n\t\t\t\t\t<oc:size />\n\t\t\t\t\t<oc:fileid />\n\t\t\t\t\t<nc:has-preview />\n\t\t\t\t</d:prop>\n\t\t\t</d:propfind>',details:!0});case 2:return r=t.sent,t.abrupt("return",null==r||null===(n=r.data)||void 0===n?void 0:n.props);case 4:case"end":return t.stop()}}),t)})),P=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){O(i,r,o,a,s,"next",t)}function s(t){O(i,r,o,a,s,"throw",t)}a(void 0)}))}).apply(this,arguments);var t}var N=r(93664),F=r(79753);function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function z(){z=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),s=new k(o||[]);return r(a,"_invoke",{value:b(t,n,s)}),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function h(){}function f(){}var m={};c(m,i,(function(){return this}));var A=Object.getPrototypeOf,v=A&&A(A(S([])));v&&v!==e&&n.call(v,i)&&(m=v);var g=f.prototype=p.prototype=Object.create(m);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function o(r,i,a,s){var c=u(t[r],t,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==R(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,s)}))}s(c.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=u(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=f,r(g,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(C.prototype),c(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function G(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}var $=function(){var e,n=(e=z().mark((function e(n,r){var o;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.Z.post((0,F.generateOcsUrl)("apps/files_sharing/api/v1/",2)+"shares",{shareType:3,path:n,shareWith:r});case 3:return o=e.sent,e.abrupt("return",o.data.ocs.data.url);case 7:if(e.prev=7,e.t0=e.catch(0),!(e.t0.response&&e.t0.response.data&&e.t0.response.data.ocs&&e.t0.response.data.ocs.meta&&e.t0.response.data.ocs.meta.message)){e.next=15;break}throw console.error("Error while sharing file: ".concat(e.t0.response.data.ocs.meta.message||"Unknown error")),(0,i.x2)(e.t0.response.data.ocs.meta.message),e.t0;case 15:throw console.error("Error while sharing file: Unknown error"),(0,i.x2)(t("mail","Error while sharing file")),e.t0;case 18:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(t){G(i,r,o,a,s,"next",t)}function s(t){G(i,r,o,a,s,"throw",t)}a(void 0)}))});return function(t,e){return n.apply(this,arguments)}}(),Z=r(80413),U=r(82675),V=r(40765),q={name:"ComposerAttachment",components:{Close:U.default,Cloud:V.Z},props:{bus:{type:Object,required:!0},attachment:{type:Object,required:!0},uploading:{type:Boolean,default:!1}},data:function(){return{progress:0,sizeString:"",finished:!1}},computed:{previewURL:function(){return this.attachment.hasPreview&&this.attachment.id>0?(0,F.generateUrl)("/core/preview?fileId=".concat(this.attachment.id,"&x=100&y=100&a=0")):""},getIcon:function(){return OC.MimeType.getIconUrl(this.attachment.fileType)},extension:function(){return this.attachment.fileName.split(".").pop()}},methods:{onDelete:function(t){this.$emit("on-delete-attachment",t)}}},Y=r(93379),W=r.n(Y),H=r(7795),K=r.n(H),Q=r(90569),X=r.n(Q),J=r(3565),tt=r.n(J),et=r(19216),nt=r.n(et),rt=r(44589),ot=r.n(rt),it=r(33706),at={};at.styleTagTransform=ot(),at.setAttributes=tt(),at.insert=X().bind(null,"head"),at.domAPI=K(),at.insertStyleElement=nt(),W()(it.Z,at),it.Z&&it.Z.locals&&it.Z.locals;var st=r(51900),ct=(0,st.Z)(q,(function(){var t=this,e=t._self._c;return e("li",{staticClass:"composer-attachment",class:{"composer-attachment--with-error":t.attachment.error}},[e("div",{staticClass:"attachment-preview"},[!1!==t.attachment.imageBlobURL?e("img",{staticClass:"attachment-preview-image",attrs:{src:t.attachment.imageBlobURL}}):t.attachment.hasPreview?e("img",{staticClass:"attachment-preview-image",attrs:{src:t.previewURL}}):e("img",{staticClass:"attachment-preview-image",attrs:{src:t.getIcon}}),t._v(" "),"cloud"===t.attachment.type?e("span",{staticClass:"cloud-attachment-icon"},[e("Cloud",{attrs:{size:16}})],1):t._e()]),t._v(" "),e("div",{staticClass:"attachment-inner"},[e("span",{staticClass:"new-message-attachment-name"},[t._v("\n\t\t\t"+t._s(t.attachment.displayName?t.attachment.displayName:t.attachment.fileName)+"\n\t\t")]),t._v(" "),t.attachment.finished?e("span",{staticClass:"new-message-attachment-size"},[t._v(t._s(t.attachment.sizeString))]):e("span",{staticClass:"attachments-upload-progress"},[e("span",{staticClass:"attachments-upload-progress--bar",style:"width:"+t.attachment.percent+"%"})])]),t._v(" "),e("button",{on:{click:function(e){return t.onDelete(t.attachment)}}},[e("Close",{attrs:{size:24}})],1)])}),[],!1,null,"47464ade",null).exports,lt=r(41622),ut=r(50009);function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}function pt(){pt=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),s=new k(o||[]);return r(a,"_invoke",{value:b(t,n,s)}),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function h(){}function f(){}var m={};c(m,i,(function(){return this}));var A=Object.getPrototypeOf,v=A&&A(A(S([])));v&&v!==e&&n.call(v,i)&&(m=v);var g=f.prototype=p.prototype=Object.create(m);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function o(r,i,a,s){var c=u(t[r],t,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==dt(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,s)}))}s(c.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=u(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=f,r(g,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(C.prototype),c(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function ht(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function ft(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ht(i,r,o,a,s,"next",t)}function s(t){ht(i,r,o,a,s,"throw",t)}a(void 0)}))}}var mt=["image/gif","image/jpeg","image/pjpeg","image/png","image/webp"],At={name:"ComposerAttachments",components:{ComposerAttachment:ct,ChevronDown:lt.default,ChevronUp:ut.default},props:{value:{type:Array,required:!0},bus:{type:Object,required:!0},uploadSizeLimit:{type:Number,default:0}},data:function(){return{uploading:!1,uploads:{},attachments:[],isToggle:!1,hasNextLine:!1}},computed:{hasAttachmentErrors:function(){return this.attachments.some((function(t){return t.error}))},uploadProgress:function(){var t=0,e=0;for(var n in this.uploads)t+=this.uploads[n].uploaded,e+=this.uploads[n].total;return(t/e*100).toFixed(1)},total:function(){var t=0;for(var e in this.uploads)t+=this.uploads[e].total;return t}},watch:{attachments:function(){this.$nextTick((function(){var t=this,e=null;this.$refs.attachments.some((function(n,r){var o=n.$el.getBoundingClientRect().top;return null!==e&&e!==o?(t.hasNextLine||(t.isToggle=!0,t.hasNextLine=!0),!0):(e=o,t.$refs.attachments.length===r+1&&(t.hasNextLine=!1,t.isToggle=!1,!0))}))}))}},created:function(){var t=this;this.bus.$on("on-add-local-attachment",this.onAddLocalAttachment),this.bus.$on("on-add-cloud-attachment",this.onAddCloudAttachment),this.bus.$on("on-add-cloud-attachment-link",this.onAddCloudAttachmentLink),this.value.map((function(e){return t.attachments.push({id:e.id,fileName:e.fileName,displayName:A()("/",e.fileName),total:e.size,finished:!0,sizeString:t.formatBytes(e.size),imageBlobURL:e.isImage?e.downloadUrl:e.mimeUrl}),e}))},methods:{onAddLocalAttachment:function(){this.$refs.localAttachments.click()},emitNewAttachments:function(t){this.$emit("input",this.value.concat(t))},totalSizeOfUpload:function(){return Object.values(this.value).reduce((function(t,e){return"local"===!e.type?t:t+e.size}),0)},onLocalAttachmentSelected:function(t){var e=this;this.uploading=!0,I.ZP.set(this,"uploads",{});var n=D()(L()("size"),Object.values(t.target.files)),r=n+this.totalSizeOfUpload();if(s.Z.debug("checking upload size limit",{existingUploads:this.totalSizeOfUpload(),toUpload:n,limit:this.uploadSizeLimit,newTotal:r}),this.uploadSizeLimit&&r>this.uploadSizeLimit)return this.showAttachmentFileSizeWarning(t.target.files.length),void(this.uploading=!1);var o=x()((function(t){var n,r=new AbortController;e.attachments.push({fileName:t.name,fileType:t.type,imageBlobURL:e.generatePreview(t),displayName:A()("/",t.name),progress:null,percent:0,total:t.size,finished:!1,error:!1,hasPreview:!1,controller:r}),I.ZP.set(e.uploads,t.name,{total:t.size,uploaded:0});try{return(0,Z.L5)(t,(n=t.name,function(t,r){e.uploads[n].uploaded=r,e.attachments.map((function(t,o){return t.displayName===n&&(e.attachments[o].progress=r,e.changeProgress(t,r)),t}))}),r).catch((function(){e.attachments.some((function(n){return n.displayName===t.name&&!n.error&&(e.$set(n,"error",!0),!0)}))})).then((function(t){var n=t.file,r=t.id;s.Z.info("local attachment uploaded",{file:n,id:r}),e.emitNewAttachments([{fileName:n.name,displayName:A()("/",n.name),id:r,size:n.size,type:"local"}])}))}catch(e){s.Z.error("Could not upload file",{file:t,error:e})}}),t.target.files),i=Promise.all(o).catch((function(t){return s.Z.error("could not upload all attachments",{error:t})})).then((function(){return e.uploading=!1}));return this.$emit("upload",i),i},onAddCloudAttachment:function(){var t=this;return ft(pt().mark((function e(){var n,r,o,c,l;return pt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,i.fn)((0,a.Iu)("mail","Choose a file to add as attachment")).setMultiSelect(!0).build(),e.prev=1,e.next=4,n.pick((0,a.Iu)("mail","Choose a file to add as attachment"));case 4:return r=e.sent,e.next=7,Promise.all(r.map(j));case 7:if(o=e.sent,c=o.reduce((function(t,e){return t+e.size}),0),l=c+t.totalSizeOfUpload(),!(t.uploadSizeLimit&&l>t.uploadSizeLimit)){e.next=13;break}return t.showAttachmentFileSizeWarning(r.length),e.abrupt("return");case 13:t.emitNewAttachments(r.map((function(e,n){var r={fileName:e,displayName:A()("/",e),type:"cloud",size:o[n].size},i={finished:!0,imageBlobURL:t.generatePreview(r),total:o[n].size,sizeString:t.formatBytes(o[n].size),hasPreview:o[n]["has-preview"],id:o[n].fileid,uploaded:0};return t.attachments.push(Object.assign(i,r)),r}))),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),s.Z.error("could not choose a file as attachment",{error:e.t0});case 19:case"end":return e.stop()}}),e,null,[[1,16]])})))()},onAddCloudAttachmentLink:function(){var t=this;return ft(pt().mark((function e(){var n,r,o;return pt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,i.fn)((0,a.Iu)("mail","Choose a file to share as a link")).build(),e.prev=1,e.next=4,n.pick((0,a.Iu)("mail","Choose a file to share as a link"));case 4:return r=e.sent,e.next=7,$(r,(0,_.IH)());case 7:o=e.sent,t.appendToBodyAtCursor('<a href="'.concat(o,'">').concat(o,"</a>")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),s.Z.error("could not choose a file as attachment link",{error:e.t0});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))()},showAttachmentFileSizeWarning:function(t){(0,i.K2)((0,a.uN)("mail","The attachment exceed the allowed attachments size of {size}. Please share the file via link instead.","The attachments exceed the allowed attachments size of {size}. Please share the files via link instead.",t,{size:(0,k.s)(this.uploadSizeLimit)}))},onDelete:function(t){t.finished||t.controller.abort();var e=t.fileName,n=(t.displayName,t.id),r=(t.total,t.type),o=this.attachments.filter((function(e){return e!==t}));this.attachments=o,this.$emit("input",this.value.filter((function(t){return"cloud"===r?t.fileName!==e:t.id!==n})))},appendToBodyAtCursor:function(t){this.bus.$emit("append-to-body-at-cursor",t)},formatBytes:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===t)return"0 B";var n=e<0?0:e,r=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,r)).toFixed(n))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][r]},changeProgress:function(t,e){var n=this;this.attachments.map((function(r,o){if(t.fileName===r.fileName&&!r.finished){var i=e<=r.total?e:r.total;n.$set(r,"progress",i),n.$set(r,"sizeString",n.formatBytes(i)),n.$set(r,"percent",i/r.total*100).toFixed(1),t.total<=i&&n.$set(r,"finished",!0)}return r}))},generatePreview:function(t){return!!this.isImage(t)&&URL.createObjectURL(t)},isImage:function(t){return t.type&&-1!==mt.indexOf(t.type)}}},vt=At,gt=r(5070),yt={};yt.styleTagTransform=ot(),yt.setAttributes=tt(),yt.insert=X().bind(null,"head"),yt.domAPI=K(),yt.insertStyleElement=nt(),W()(gt.Z,yt),gt.Z&&gt.Z.locals&&gt.Z.locals;var Ct=(0,st.Z)(vt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"new-message-attachments"},[t.hasNextLine?e("div",{staticClass:"new-message-attachments--counter",class:{"new-message-attachments--counter--with-errors":t.hasAttachmentErrors},on:{click:function(e){t.isToggle=!t.isToggle}}},[e("span",[t._v("\n\t\t\t"+t._s(t.n("mail","{count} attachment","{count} attachments",t.attachments.length,{count:t.attachments.length}))+" ("+t._s(t.formatBytes(t.totalSizeOfUpload()))+")\n\t\t")]),t._v(" "),t.isToggle?e("ChevronUp",{attrs:{size:24}}):t._e(),t._v(" "),t.isToggle?t._e():e("ChevronDown",{attrs:{size:24}})],1):t._e(),t._v(" "),e("ul",{staticClass:"new-message-attachments--list",class:{hide:t.isToggle,active:!t.isToggle&&t.hasNextLine}},t._l(t.attachments,(function(n){return e("ComposerAttachment",{key:n.id,ref:"attachments",refInFor:!0,attrs:{bus:t.bus,attachment:n,uploading:t.uploading},on:{"on-delete-attachment":function(e){return t.onDelete(n)}}})})),1),t._v(" "),e("input",{ref:"localAttachments",staticStyle:{display:"none"},attrs:{type:"file",multiple:""},on:{change:t.onLocalAttachmentSelected}})])}),[],!1,null,"7f752cca",null).exports,bt=r(41293),wt=r(86119),xt=r(34829),_t=r(19695),kt=r(21666),St={name:"RecipientListItem",components:{ListItemIcon:o.Ic,Close:U.default},props:{option:{type:Object,required:!0}},methods:{removeRecipient:function(t,e){this.$emit("remove-recipient",t,e)}}},Lt=r(66515),Et={};Et.styleTagTransform=ot(),Et.setAttributes=tt(),Et.insert=X().bind(null,"head"),Et.domAPI=K(),Et.insertStyleElement=nt(),W()(Lt.Z,Et),Lt.Z&&Lt.Z.locals&&Lt.Z.locals;var Dt=(0,st.Z)(St,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"multiselect__tag multiselect__tag--recipient"},[e("ListItemIcon",{attrs:{"no-margin":!0,title:t.option.label,url:t.option.photo,"avatar-size":24}}),t._v(" "),e("Close",{staticClass:"delete-recipient",attrs:{size:20},on:{click:function(e){return e.preventDefault(),t.removeRecipient(t.option)}}})],1)}),[],!1,null,"7614adf2",null).exports,It=r(90446),Bt=r(13312),Mt=r(56501),Tt=r(83138),Ot=r(22717),jt=r(31588),Pt=r(52796);function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Ft(){Ft=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),s=new k(o||[]);return r(a,"_invoke",{value:b(t,n,s)}),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function h(){}function f(){}var m={};c(m,i,(function(){return this}));var A=Object.getPrototypeOf,v=A&&A(A(S([])));v&&v!==e&&n.call(v,i)&&(m=v);var g=f.prototype=p.prototype=Object.create(m);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function o(r,i,a,s){var c=u(t[r],t,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==Nt(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,s)}))}s(c.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=u(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=f,r(g,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(C.prototype),c(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function Rt(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function zt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Rt(i,r,o,a,s,"next",t)}function s(t){Rt(i,r,o,a,s,"throw",t)}a(void 0)}))}}var Gt={name:"MailvelopeEditor",props:{value:{type:String,required:!0},recipients:{type:Array,required:!0},quotedText:{type:Object,required:!1,default:function(){}},isReplyOrForward:{type:Boolean,default:!1}},data:function(){return{editor:void 0}},mounted:function(){var t=this;return zt(Ft().mark((function e(){var n,r,o;return Ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!!t.quotedText&&(0,Pt.b)(t.quotedText),o=t.isReplyOrForward?null===(n=t.quotedText)||void 0===n?void 0:n.value:void 0,e.next=4,window.mailvelope.createEditorContainer("#mailvelope-composer",void 0,{quotedMail:r?o:void 0});case 4:t.editor=e.sent;case 5:case"end":return e.stop()}}),e)})))()},methods:{pull:function(){var t=this;return zt(Ft().mark((function e(){var n,r;return Ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.recipients.map((function(t){return t.email})),s.Z.info("encrypting message",{recipients:n}),e.next=4,t.editor.encrypt(n);case 4:r=e.sent,s.Z.info("message encryted",{armored:r}),t.$emit("input",r);case 7:case"end":return e.stop()}}),e)})))()}}},$t=r(30980),Zt={};Zt.styleTagTransform=ot(),Zt.setAttributes=tt(),Zt.insert=X().bind(null,"head"),Zt.domAPI=K(),Zt.insertStyleElement=nt(),W()($t.Z,Zt),$t.Z&&$t.Z.locals&&$t.Z.locals;var Ut=(0,st.Z)(Gt,(function(){return(0,this._self._c)("div",{attrs:{id:"mailvelope-composer"}})}),[],!1,null,"0be7aff6",null).exports,Vt=r(90066),qt=r(86680),Yt=r(7844),Wt=r(77274),Ht=r(80351),Kt=r.n(Ht),Qt=r(20629),Xt=r(11130),Jt=r(98238);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ne(){ne=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),s=new k(o||[]);return r(a,"_invoke",{value:b(t,n,s)}),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function h(){}function f(){}var m={};c(m,i,(function(){return this}));var A=Object.getPrototypeOf,v=A&&A(A(S([])));v&&v!==e&&n.call(v,i)&&(m=v);var g=f.prototype=p.prototype=Object.create(m);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function o(r,i,a,s){var c=u(t[r],t,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==te(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,s)}))}s(c.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=u(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=f,r(g,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(C.prototype),c(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function re(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function oe(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){re(i,r,o,a,s,"next",t)}function s(t){re(i,r,o,a,s,"throw",t)}a(void 0)}))}}function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(n),!0).forEach((function(e){se(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function se(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==te(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===te(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ce=y()(Tt.l,500);I.ZP.use(v);var le={name:"Composer",components:{MailvelopeEditor:Ut,Actions:o.O3,ActionButton:o.Js,ActionCheckbox:o.Bt,ActionInput:o.Iw,ActionRadio:o.Iz,ButtonVue:o.P2,ComposerAttachments:Ct,ChevronLeft:C.default,Delete:b.Z,Download:bt.Z,IconUpload:wt.Z,IconFolder:xt.default,IconPublic:_t.Z,IconLinkPicker:kt.Z,Multiselect:o.Z2,TextEditor:Ot.Z,ListItemIcon:o.Ic,RecipientListItem:Dt,Send:Yt.Z,SendClock:Wt.Z,UnfoldMoreHorizontal:It.Z,UnfoldLessHorizontal:Bt.Z,IconHtml:Mt.Z,IconClose:U.default,NcReferencePickerModal:qt.NcReferencePickerModal},props:{fromAccount:{type:Number,default:function(){}},fromAlias:{type:Number,default:void 0},to:{type:Array,default:function(){return[]}},cc:{type:Array,default:function(){return[]}},bcc:{type:Array,default:function(){return[]}},subject:{type:String,default:""},body:{type:Object,default:function(){return(0,c.dy)("")}},editorBody:{type:String,default:""},inReplyToMessageId:{type:String,default:void 0},replyTo:{type:Object,required:!1,default:function(){}},forwardFrom:{type:Object,required:!1,default:function(){}},forwardedMessages:{type:Array,required:!1,default:function(){return[]}},sendAt:{type:Number,default:void 0},attachmentsData:{type:Array,default:function(){return[]}},error:{type:String,default:void 0},canSaveDraft:{type:Boolean,default:!1},uploadingAttachments:{type:Boolean,default:!1},savingDraft:{type:Boolean,default:!1},draftSaved:{type:Boolean,default:!1},smimeSign:{type:Boolean,default:!1},smimeEncrypt:{type:Boolean,default:!1},isFirstOpen:{type:Boolean,required:!0},requestMdn:{type:Boolean,default:!1}},data:function(){var t,e,n,r,o=new Date;return o.setHours(o.getHours()+1),{showCC:this.cc.length>0,showBCC:this.bcc.length>0,selectedAlias:-1,autocompleteRecipients:this.to.concat(this.cc).concat(this.bcc),newRecipients:[],subjectVal:this.subject,bodyVal:this.editorBody,attachments:this.attachmentsData,noReply:this.to.some((function(t){var e,n;return(null===(e=t.email)||void 0===e?void 0:e.startsWith("noreply@"))||(null===(n=t.email)||void 0===n?void 0:n.startsWith("no-reply@"))})),saveDraftDebounced:u()(5e3,this.saveDraft),selectTo:this.to,selectCc:this.cc,selectBcc:this.bcc,bus:new I.ZP,encrypt:!1,mailvelope:{available:!1,keyRing:void 0,keysMissing:[]},editorMode:"html"!==(null===(t=this.body)||void 0===t?void 0:t.format)?Jt.GZ:Jt.bu,addShareLink:(0,a.Iu)("mail","Add share link from {productName} Files",{productName:null!==(e=null===(n=OC)||void 0===n||null===(r=n.theme)||void 0===r?void 0:r.name)&&void 0!==e?e:"Nextcloud"}),requestMdnVal:this.requestMdn,changeSignature:!1,loadingIndicatorTo:!1,loadingIndicatorCc:!1,loadingIndicatorBcc:!1,isActionsOpen:!1,isMoreActionsOpen:!1,selectedDate:o,sendAtVal:this.sendAt,firstDayDatetimePicker:0===(0,a.yo)()?7:(0,a.yo)(),formatter:{stringify:function(t){return t?Kt()(t).format("LLL"):""},parse:function(t){return t?Kt()(t,"LLL").toDate():null}},autoLimit:!0,wantsSmimeSign:this.smimeSign,wantsSmimeEncrypt:this.smimeEncrypt,isPickerOpen:!1}},computed:ae(ae({},(0,Qt.Se)(["isScheduledSendingDisabled"])),{},{isPickerAvailable:function(){return parseInt(this.$store.getters.getNcVersion)>=26},aliases:function(){var t=0;return this.$store.getters.accounts.filter((function(t){return!t.isUnified})).flatMap((function(e){return[{id:e.id,aliasId:null,selectId:t++,editorMode:e.editorMode,signature:e.signature,name:e.name,emailAddress:e.emailAddress,signatureAboveQuote:e.signatureAboveQuote,smimeCertificateId:e.smimeCertificateId},e.aliases.map((function(n){return{id:e.id,aliasId:n.id,selectId:t++,editorMode:e.editorMode,signature:n.signature,name:n.name,emailAddress:n.alias,signatureAboveQuote:e.signatureAboveQuote,smimeCertificateId:n.smimeCertificateId}}))]})).flat()},allRecipients:function(){return this.selectTo.concat(this.selectCc).concat(this.selectBcc)},dateToday:function(){return new Date((new Date).setDate((new Date).getDate()))},attachmentSizeLimit:function(){return this.$store.getters.getPreference("attachment-size-limit")},selectableRecipients:function(){return this.newRecipients.concat(this.autocompleteRecipients).map((function(t){return ae(ae({},t),{},{label:t.label||t.email})}))},isForward:function(){return void 0!==this.forwardFrom},isReply:function(){return void 0!==this.replyTo},canSend:function(){return!(this.wantsSmimeEncrypt&&(!this.smimeCertificateForCurrentAlias||this.missingSmimeCertificatesForRecipients.length)||this.encrypt&&this.mailvelope.keysMissing.length||!(this.selectTo.length>0||this.selectCc.length>0||this.selectBcc.length>0))},editorPlainText:function(){return this.editorMode===Jt.GZ},submitButtonTitle:function(){return this.wantsSmimeEncrypt?this.sendAtVal?(0,a.Iu)("mail","Encrypt with S/MIME and send later")+" ".concat(this.convertToLocalDate(this.sendAtVal)):(0,a.Iu)("mail","Encrypt with S/MIME and send"):this.mailvelope.available&&this.encrypt?this.sendAtVal?(0,a.Iu)("mail","Encrypt with Mailvelope and send later")+" ".concat(this.convertToLocalDate(this.sendAtVal)):(0,a.Iu)("mail","Encrypt with Mailvelope and send"):this.sendAtVal?(0,a.Iu)("mail","Send later")+" ".concat(this.convertToLocalDate(this.sendAtVal)):(0,a.Iu)("mail","Send")},dateTomorrowMorning:function(){var t=new Date;return t.setTime(t.getTime()+864e5),t.setHours(9,0,0,0)},dateTomorrowAfternoon:function(){var t=new Date;return t.setTime(t.getTime()+864e5),t.setHours(14,0,0,0)},dateMondayMorning:function(){var t=new Date;return t.setHours(9,0,0,0),t.setDate(t.getDate()+(7-t.getDay())%7+1)},customSendTime:function(){return new Date(this.selectedDate).getTime()},showAmPm:function(){return-1!==Kt()().locale((0,a.Kd)()).localeData().longDateFormat("LT").toLowerCase().indexOf("a")},isSendAtTomorrowMorning:function(){return!(!this.sendAtVal||Math.floor(this.dateTomorrowMorning/1e3)!==Math.floor(this.sendAtVal/1e3))},isSendAtTomorrowAfternoon:function(){return!(!this.sendAtVal||Math.floor(this.dateTomorrowAfternoon/1e3)!==Math.floor(this.sendAtVal/1e3))},isSendAtMondayMorning:function(){return!(!this.sendAtVal||Math.floor(this.dateMondayMorning/1e3)!==Math.floor(this.sendAtVal/1e3))},isSendAtCustom:function(){return!(!this.sendAtVal||this.isSendAtTomorrowMorning||this.isSendAtTomorrowAfternoon||this.isSendAtMondayMorning)},smimeCertificateForCurrentAlias:function(){if(-1!==this.selectedAlias)return this.smimeCertificateForAlias(this.selectedAlias)},shouldSmimeSign:function(){return this.wantsSmimeSign&&!!this.smimeCertificateForCurrentAlias},shouldSmimeEncrypt:function(){return this.wantsSmimeEncrypt&&!!this.smimeCertificateForCurrentAlias&&0===this.missingSmimeCertificatesForRecipients.length},missingSmimeCertificatesForRecipients:function(){var t=this,e=[];return this.allRecipients.forEach((function(n){t.$store.getters.getSmimeCertificateByEmail(n.email)||e.push(n.email)})),e}}),watch:{"$route.params.threadId":function(){this.reset()},allRecipients:function(){this.checkRecipientsKeys()},aliases:function(t){var e=this;if(console.debug("aliases changed"),-1!==this.selectedAlias){var n=t.find((function(t){return t.id===e.selectedAlias.id&&t.aliasId===e.selectedAlias.aliasId}));void 0===n?this.onAliasChange(t[0]):this.onAliasChange(n)}},selectTo:function(t){this.$emit("update:to",t)},selectCc:function(t){this.$emit("update:cc",t)},selectBcc:function(t){this.$emit("update:bcc",t)},subjectVal:function(t){this.$emit("update:subject",t)},bodyVal:function(t){this.$emit("update:editor-body",t)},attachments:function(t){this.$emit("update:attachments-data",t)},sendAtVal:function(t){this.$emit("update:send-at",t)},wantsSmimeSign:function(t){this.$emit("update:smime-sign",t)},wantsSmimeEncrypt:function(t){this.$emit("update:smime-encrypt",t)},requestMdnVal:function(t){this.$emit("update:request-mdn",t)}},beforeMount:function(){var t=this;return oe(ne().mark((function e(){return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setAlias(),t.initBody(),e.t0=t,e.next=5,(0,Vt.T)();case 5:return e.t1=e.sent,e.next=8,e.t0.onMailvelopeLoaded.call(e.t0,e.t1);case 8:case"end":return e.stop()}}),e)})))()},mounted:function(){var t,e=this;!this.isReply&&this.isFirstOpen&&this.$nextTick((function(){return e.$refs.toLabel.$el.focus()})),void 0!==(null===(t=this.forwardFrom)||void 0===t?void 0:t.attachments)&&this.forwardFrom.attachments.forEach((function(t){e.attachments.push({fileName:t.fileName,displayName:A()("/",t.fileName),id:t.id,messageId:e.forwardFrom.databaseId,type:"message-attachment"})}));var n=[];this.forwardedMessages&&!f()(this.forwardedMessages)?n=[this.forwardedMessages]:this.forwardedMessages&&f()(this.forwardedMessages)&&(n=this.forwardedMessages),n.forEach((function(t){var n=e.$store.getters.getEnvelope(t);n?e.attachments.push({displayName:n.subject+".eml",id:t,type:"message"}):(0,i.x2)((0,a.Iu)("mail","Message {id} could not be found",{id:t}))})),this.sendAt&&this.isSendAtCustom&&(this.selectedDate=new Date(this.sendAt))},beforeDestroy:function(){window.removeEventListener("mailvelope",this.onMailvelopeLoaded)},methods:{handleShow:function(t){this.$emit("show-toolbar",t)},openPicker:function(){this.isPickerOpen=!0},closePicker:function(){this.isPickerOpen=!1},setAlias:function(){var t=this,e=this.selectedAlias;if(this.fromAccount&&this.fromAlias)this.selectedAlias=this.aliases.find((function(e){return e.id===t.fromAccount&&e.aliasId===t.fromAlias}));else if(this.fromAccount)this.selectedAlias=this.aliases.find((function(e){return e.id===t.fromAccount&&!e.aliasId}));else{var n,r=null===(n=this.$store.getters.getMailbox(this.$route.params.mailboxId))||void 0===n?void 0:n.accountId;this.selectedAlias=r?this.aliases.find((function(t){return t.id===r})):this.aliases[0]}-1!==e||this.body&&""!==this.body.value||(this.editorMode=this.selectedAlias.editorMode)},checkRecipientsKeys:function(){var t=this;return oe(ne().mark((function e(){var n,r;return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.encrypt&&t.mailvelope.available){e.next=2;break}return e.abrupt("return");case 2:return n=t.allRecipients.map((function(t){return t.email})),e.next=5,t.mailvelope.keyRing.validKeyForAddress(n);case 5:r=e.sent,s.Z.debug("recipients keys validated",{recipients:n,keysValid:r}),t.mailvelope.keysMissing=n.filter((function(t){return!1===r[t]}));case 8:case"end":return e.stop()}}),e)})))()},initBody:function(){var t;t=this.replyTo&&this.isFirstOpen?(0,jt.Gx)(this.editorPlainText?(0,c.UK)(this.body):(0,c.vb)(this.body),this.replyTo.from[0],this.replyTo.dateInt,"top"===this.$store.getters.getPreference("reply-mode","top")).value:this.forwardFrom&&this.isFirstOpen?(0,jt.Gx)(this.editorPlainText?(0,c.UK)(this.body):(0,c.vb)(this.body),this.forwardFrom.from[0],this.forwardFrom.dateInt,"top"===this.$store.getters.getPreference("reply-mode","top")).value:this.bodyVal,this.bodyVal=(0,c.dy)(t).value},getMessageData:function(){var t,e;return{account:this.selectedAlias.id,accountId:this.selectedAlias.id,aliasId:this.selectedAlias.aliasId,to:this.selectTo,cc:this.selectCc,bcc:this.selectBcc,subject:this.subjectVal,body:this.encrypt?(0,c.Oh)(this.bodyVal):(0,c.dy)(this.bodyVal),attachments:this.attachments,inReplyToMessageId:null!==(t=this.inReplyToMessageId)&&void 0!==t?t:this.replyTo?this.replyTo.messageId:void 0,isHtml:!this.encrypt&&!this.editorPlainText,requestMdn:this.requestMdnVal,sendAt:this.sendAtVal?Math.floor(this.sendAtVal/1e3):void 0,smimeSign:this.shouldSmimeSign,smimeEncrypt:this.shouldSmimeEncrypt,smimeCertificateId:null===(e=this.smimeCertificateForCurrentAlias)||void 0===e?void 0:e.id}},saveDraft:function(){var t,e=this.getMessageData();""!==e.subject||""!==(null===(t=e.body)||void 0===t?void 0:t.value)||0!==e.cc.length||0!==e.bcc.length||0!==e.to.length||void 0!==e.sendAt?this.$emit("draft",e):s.Z.debug("Nothing substantial to save, ignoring draft save")},insertSignature:function(){var t;t=this.changeSignature?Xt.tj:Xt.LQ,this.$refs.editor.editorExecute("insertSignature",t,(0,c.vb)((0,c.qY)(this.selectedAlias.signature)).value,this.selectedAlias.signatureAboveQuote),this.changeSignature=!1},onPicked:function(t){this.closePicker(),this.bus.$emit("append-to-body-at-cursor",t)},onEditorInput:function(t){this.bodyVal=t,this.saveDraftDebounced()},onEditorReady:function(t){this.bodyVal=t.getData(),this.insertSignature()},onChangeSendLater:function(t){this.sendAtVal=t?Number.parseInt(t,10):void 0},convertToLocalDate:function(t){return new Date(t).toLocaleString((0,a.aj)(),{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},onAliasChange:function(t){s.Z.debug("changed alias",{alias:t}),this.selectedAlias=t,this.changeSignature=!0,this.$emit("update:from-account",t.id),t.aliasId&&this.$emit("update:from-alias",t.aliasId),(this.wantsSmimeSign||this.wantsSmimeEncrypt)&&(this.smimeCertificateForAlias(t)||(this.wantsSmimeSign=!1,this.wantsSmimeEncrypt=!1,(0,i.K2)((0,a.Iu)("mail","Sign or Encrypt with S/MIME was selected, but we don't have a certificate for the selected alias. The message will not be signed or encrypted.")))),this.editorMode===Jt.GZ&&t.editorMode===Jt.bu?this.editorMode=Jt.bu:this.insertSignature()},onAddLocalAttachment:function(){this.bus.$emit("on-add-local-attachment"),this.saveDraftDebounced()},onAddCloudAttachment:function(){this.bus.$emit("on-add-cloud-attachment"),this.saveDraftDebounced()},onAddCloudAttachmentLink:function(){this.bus.$emit("on-add-cloud-attachment-link")},onAutocomplete:function(t,e){var n=this;void 0!==t&&""!==t&&(this.loadingIndicatorTo="to"===e,this.loadingIndicatorCc="cc"===e,this.loadingIndicatorBcc="bcc"===e,ce(t).then((function(t){"to"===e?n.loadingIndicatorTo=!1:"cc"===e?n.loadingIndicatorCc=!1:"bcc"===e&&(n.loadingIndicatorBcc=!1);var r,o=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ee(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;i.label||(i.label=i.email)}}catch(t){o.e(t)}finally{o.f()}n.autocompleteRecipients=p()("email")(n.autocompleteRecipients.concat(t))})))},onMailvelopeLoaded:function(t){var e=this;return oe(ne().mark((function n(){return ne().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.encrypt=(0,Pt.b)(e.body),e.mailvelope.available=!0,s.Z.info("Mailvelope loaded",{encrypt:e.encrypt,isPgpgMessage:(0,Pt.b)(e.body),keyRing:e.mailvelope.keyRing}),n.next=5,t.getKeyring();case 5:return e.mailvelope.keyRing=n.sent,n.next=8,e.checkRecipientsKeys();case 8:case"end":return n.stop()}}),n)})))()},onNewToAddr:function(t){this.onNewAddr(t,this.selectTo)},onNewCcAddr:function(t){this.onNewAddr(t,this.selectCc)},onNewBccAddr:function(t){this.onNewAddr(t,this.selectBcc)},onNewAddr:function(t,e){var n=t;"string"==typeof t&&(n={label:t,email:t}),this.newRecipients.push(n),e.push(n),this.saveDraftDebounced()},onSend:function(t){var e=arguments,n=this;return oe(ne().mark((function t(){var r;return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.length>1&&void 0!==e[1]&&e[1],!n.encrypt){t.next=5;break}return s.Z.debug("get encrypted message from mailvelope"),t.next=5,n.$refs.mailvelopeEditor.pull();case 5:n.$emit("send",ae(ae({},n.getMessageData()),{},{force:r}));case 6:case"end":return t.stop()}}),t)})))()},reset:function(){this.selectTo=[],this.selectCc=[],this.selectBcc=[],this.subjectVal="",this.bodyVal="<p></p><p></p>",this.attachments=[],this.autocompleteRecipients=[],this.newRecipients=[],this.requestMdnVal=!1,this.changeSignature=!1,this.sendAtVal=void 0,this.setAlias(),this.initBody()},formatAliases:function(t){return t.name?"".concat(t.name," <").concat(t.emailAddress,">"):t.emailAddress},disabledDatetimepickerDate:function(t){var e=new Date;return e.setHours(0,0,0),e.setSeconds(e.getSeconds()-1),t.getTime()<=e},disabledDatetimepickerTime:function(t){var e=new Date,n=new Date(e.getTime());return t.getTime()<=n},onRemoveRecipient:function(t,e){switch(e){case"to":this.removeRecipientTo(t);break;case"cc":this.removeRecipientCc(t);break;case"bcc":this.removeRecipientBcc(t)}},removeRecipient:function(t,e){return e.filter((function(e){return e.email!==t.email}))},removeRecipientTo:function(t){this.selectTo=this.removeRecipient(t,this.selectTo)},removeRecipientCc:function(t){this.selectCc=this.removeRecipient(t,this.selectCc)},removeRecipientBcc:function(t){this.selectBcc=this.removeRecipient(t,this.selectBcc)},toggleViewMode:function(){this.autoLimit=!this.autoLimit,this.showCC=!(this.showCC&&0===this.selectCc.length&&this.autoLimit),this.showBCC=!(this.showBCC&&0===this.selectBcc.length&&this.autoLimit)},setEditorModeHtml:function(){this.editorMode=Jt.bu},setEditorModeText:function(){var t=this;OC.dialogs.confirmDestructive((0,a.Iu)("mail","Any existing formatting (for example bold, italic, underline or inline images) will be removed."),(0,a.Iu)("mail","Turn off formatting"),{type:OC.dialogs.YES_NO_BUTTONS,confirm:(0,a.Iu)("mail","Turn off and remove formatting"),confirmClasses:"error",cancel:(0,a.Iu)("mail","Keep formatting")},(function(e){e&&(t.editorMode=Jt.GZ)}))},smimeCertificateForAlias:function(t){var e=t.smimeCertificateId;if(e)return this.$store.getters.getSmimeCertificate(e)}}},ue=le,de=r(96187),pe={};pe.styleTagTransform=ot(),pe.setAttributes=tt(),pe.insert=X().bind(null,"head"),pe.domAPI=K(),pe.insertStyleElement=nt(),W()(de.Z,pe),de.Z&&de.Z.locals&&de.Z.locals;var he=(0,st.Z)(ue,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"message-composer"},[t.isPickerAvailable&&t.isPickerOpen?e("NcReferencePickerModal",{on:{submit:t.onPicked,cancel:t.closePicker}}):t._e(),t._v(" "),e("div",{staticClass:"composer-fields composer-fields__from mail-account"},[e("label",{staticClass:"from-label",attrs:{for:"from"}},[t._v("\n\t\t\t"+t._s(t.t("mail","From"))+"\n\t\t")]),t._v(" "),e("div",{staticClass:"composer-fields--custom"},[e("Multiselect",{attrs:{id:"from",value:t.selectedAlias,options:t.aliases,label:"name","track-by":"selectId",searchable:!1,"custom-label":t.formatAliases,placeholder:t.t("mail","Select account"),"clear-on-select":!1},on:{select:t.onAliasChange}})],1)]),t._v(" "),e("div",{staticClass:"composer-fields"},[e("label",{staticClass:"to-label",attrs:{for:"to"}},[t._v("\n\t\t\t"+t._s(t.t("mail","To"))+"\n\t\t")]),t._v(" "),e("div",{staticClass:"composer-fields--custom"},[e("Multiselect",{ref:"toLabel",class:{opened:!t.autoLimit},attrs:{id:"to",options:t.selectableRecipients,taggable:!0,label:"label","track-by":"email",multiple:!0,placeholder:t.t("mail","Contact or email address "),"clear-on-select":!0,"close-on-select":!1,"show-no-options":!1,"preserve-search":!0,"hide-selected":!0,loading:t.loadingIndicatorTo,"auto-limit":t.autoLimit,"options-limit":30},on:{input:t.saveDraftDebounced,tag:t.onNewToAddr,"search-change":function(e){return t.onAutocomplete(e,"to")}},scopedSlots:t._u([{key:"tag",fn:function(n){var r=n.option;return[e("RecipientListItem",{attrs:{option:r},on:{"remove-recipient":function(e){return t.onRemoveRecipient(r,"to")}}})]}},{key:"option",fn:function(t){var n=t.option;return[e("div",{staticClass:"multiselect__tag multiselect__tag-custom"},[e("ListItemIcon",{attrs:{"no-margin":!0,title:n.label,subtitle:n.email,url:n.photo,"avatar-size":24}})],1)]}}]),model:{value:t.selectTo,callback:function(e){t.selectTo=e},expression:"selectTo"}}),t._v(" "),e("button",{class:{active:!t.autoLimit},attrs:{title:t.t("mail","Toggle recipients list mode")},on:{click:function(e){return e.preventDefault(),t.toggleViewMode.apply(null,arguments)}}},[t.autoLimit?e("UnfoldMoreHorizontal",{attrs:{size:24}}):e("UnfoldLessHorizontal",{attrs:{size:24}})],1)],1)]),t._v(" "),t.showCC?e("div",{staticClass:"composer-fields"},[e("label",{staticClass:"cc-label",attrs:{for:"cc"}},[t._v("\n\t\t\t"+t._s(t.t("mail","Cc"))+"\n\t\t")]),t._v(" "),e("div",{staticClass:"composer-fields--custom"},[e("Multiselect",{class:{opened:!t.autoLimit},attrs:{id:"cc",options:t.selectableRecipients,taggable:!0,label:"label","track-by":"email",multiple:!0,placeholder:t.t("mail","Contact or email address "),"clear-on-select":!0,"show-no-options":!1,"preserve-search":!0,loading:t.loadingIndicatorCc,"auto-limit":t.autoLimit,"hide-selected":!0,"options-limit":30},on:{input:t.saveDraftDebounced,tag:t.onNewCcAddr,"search-change":function(e){return t.onAutocomplete(e,"cc")}},scopedSlots:t._u([{key:"tag",fn:function(n){var r=n.option;return[e("RecipientListItem",{attrs:{option:r},on:{"remove-recipient":function(e){return t.onRemoveRecipient(r,"cc")}}})]}},{key:"option",fn:function(t){var n=t.option;return[e("div",{staticClass:"multiselect__tag multiselect__tag-custom"},[e("ListItemIcon",{attrs:{"no-margin":!0,title:n.label,subtitle:n.email,url:n.photo,"avatar-size":24}})],1)]}}],null,!1,1021015760),model:{value:t.selectCc,callback:function(e){t.selectCc=e},expression:"selectCc"}},[t._v(" "),t._v(" "),e("span",{attrs:{slot:"noOptions"},slot:"noOptions"},[t._v(t._s(t.t("mail","")))])])],1)]):t._e(),t._v(" "),t.showBCC?e("div",{staticClass:"composer-fields"},[e("label",{staticClass:"bcc-label",attrs:{for:"bcc"}},[t._v("\n\t\t\t"+t._s(t.t("mail","Bcc"))+"\n\t\t")]),t._v(" "),e("div",{staticClass:"composer-fields--custom"},[e("Multiselect",{class:{opened:!t.autoLimit},attrs:{id:"bcc",options:t.selectableRecipients,taggable:!0,label:"label","track-by":"email",multiple:!0,placeholder:t.t("mail","Contact or email address "),"show-no-options":!1,"clear-on-select":!0,"preserve-search":!0,loading:t.loadingIndicatorBcc,"hide-selected":!0,"options-limit":30},on:{input:t.saveDraftDebounced,tag:t.onNewBccAddr,"search-change":function(e){return t.onAutocomplete(e,"bcc")}},scopedSlots:t._u([{key:"tag",fn:function(n){var r=n.option;return[e("RecipientListItem",{attrs:{option:r},on:{"remove-recipient":function(e){return t.onRemoveRecipient(r,"bcc")}}})]}},{key:"option",fn:function(t){var n=t.option;return[e("div",{staticClass:"multiselect__tag multiselect__tag-custom"},[e("ListItemIcon",{attrs:{"no-margin":!0,title:n.label,subtitle:n.email,url:n.photo,"avatar-size":24}})],1)]}}],null,!1,2370059090),model:{value:t.selectBcc,callback:function(e){t.selectBcc=e},expression:"selectBcc"}},[t._v(" "),t._v(" "),e("span",{attrs:{slot:"noOptions"},slot:"noOptions"},[t._v(t._s(t.t("mail","No contacts found.")))])])],1)]):t._e(),t._v(" "),e("div",{staticClass:"composer-fields"},[e("label",{staticClass:"subject-label hidden-visually",attrs:{for:"subject"}},[t._v("\n\t\t\t"+t._s(t.t("mail","Subject"))+"\n\t\t")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.subjectVal,expression:"subjectVal"}],staticClass:"subject",attrs:{id:"subject",type:"text",name:"subject",autocomplete:"off",placeholder:t.t("mail","Subject ")},domProps:{value:t.subjectVal},on:{input:[function(e){e.target.composing||(t.subjectVal=e.target.value)},t.saveDraftDebounced]}})]),t._v(" "),t.noReply?e("div",{staticClass:"warning noreply-warning"},[t._v("\n\t\t"+t._s(t.t("mail","This message came from a noreply address so your reply will probably not be read."))+"\n\t")]):t._e(),t._v(" "),t.wantsSmimeEncrypt&&t.missingSmimeCertificatesForRecipients.length?e("div",{staticClass:"warning noreply-warning"},[t._v("\n\t\t"+t._s(t.t("mail","The following recipients do not have a S/MIME certificate: {recipients}.",{recipients:t.missingSmimeCertificatesForRecipients.join(", ")}))+"\n\t")]):t._e(),t._v(" "),t.encrypt&&t.mailvelope.keysMissing.length?e("div",{staticClass:"warning noreply-warning"},[t._v("\n\t\t"+t._s(t.t("mail","The following recipients do not have a PGP key: {recipients}.",{recipients:t.mailvelope.keysMissing.join(", ")}))+"\n\t")]):t._e(),t._v(" "),e("div",{staticClass:"composer-fields message-editor"},[t.encrypt?e("MailvelopeEditor",{ref:"mailvelopeEditor",attrs:{value:t.bodyVal,recipients:t.allRecipients,"quoted-text":t.body,"is-reply-or-forward":t.isReply||t.isForward},on:{input:t.onEditorInput}}):e("TextEditor",{key:t.editorMode,ref:"editor",staticClass:"message-body",attrs:{value:t.bodyVal,html:!t.editorPlainText,name:"body",placeholder:t.t("mail","Write message "),focus:t.isReply||!t.isFirstOpen,bus:t.bus},on:{input:t.onEditorInput,ready:t.onEditorReady,"show-toolbar":t.handleShow}})],1),t._v(" "),e("ComposerAttachments",{attrs:{bus:t.bus,"upload-size-limit":t.attachmentSizeLimit},on:{upload:function(e){t.$emit("upload-attachment",e,t.getMessageData())}},model:{value:t.attachments,callback:function(e){t.attachments=e},expression:"attachments"}}),t._v(" "),e("div",{staticClass:"composer-actions-right composer-actions"},[e("div",{staticClass:"composer-actions--primary-actions"},[e("p",{staticClass:"composer-actions-draft-status"},[t.savingDraft?e("span",{staticClass:"draft-status"},[t._v(t._s(t.t("mail","Saving draft ")))]):t.canSaveDraft?t.draftSaved?e("span",{staticClass:"draft-status"},[t._v(t._s(t.t("mail","Draft saved")))]):t._e():e("span",{staticClass:"draft-status"},[t._v(t._s(t.t("mail","Error saving draft")))])]),t._v(" "),t.savingDraft||t.canSaveDraft?t._e():e("ButtonVue",{staticClass:"button",attrs:{type:"tertiary","aria-label":t.t("mail","Save draft")},on:{click:t.saveDraft},scopedSlots:t._u([{key:"icon",fn:function(){return[e("Download",{attrs:{size:20,title:t.t("mail","Save draft")}})]},proxy:!0}],null,!1,2227301918)}),t._v(" "),!t.savingDraft&&t.draftSaved?e("ButtonVue",{staticClass:"button",attrs:{type:"tertiary","aria-label":t.t("mail","Discard & close draft")},on:{click:function(e){return t.$emit("discard-draft")}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("Delete",{attrs:{size:20,title:t.t("mail","Discard & close draft")}})]},proxy:!0}],null,!1,3896853704)}):t._e()],1),t._v(" "),e("div",{staticClass:"composer-actions--secondary-actions"},[e("Actions",{attrs:{open:t.isActionsOpen},on:{"update:open":function(e){t.isActionsOpen=e},close:function(e){t.isMoreActionsOpen=!1}}},[t.isMoreActionsOpen?t._e():[e("ActionButton",{on:{click:t.onAddLocalAttachment},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconUpload",{attrs:{size:20}})]},proxy:!0}],null,!1,337456192)},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Upload attachment"))+"\n\t\t\t\t\t")]),t._v(" "),e("ActionButton",{on:{click:t.onAddCloudAttachment},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconFolder",{attrs:{size:20}})]},proxy:!0}],null,!1,2686820117)},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Add attachment from Files"))+"\n\t\t\t\t\t")]),t._v(" "),e("ActionButton",{attrs:{disabled:t.encrypt},on:{click:t.onAddCloudAttachmentLink},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconPublic",{attrs:{size:20}})]},proxy:!0}],null,!1,1361450402)},[t._v("\n\t\t\t\t\t\t"+t._s(t.addShareLink)+"\n\t\t\t\t\t")]),t._v(" "),t.isPickerAvailable?e("ActionButton",{attrs:{"close-after-click":!0},on:{click:t.openPicker},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconLinkPicker",{attrs:{size:20}})]},proxy:!0}],null,!1,3539100229)},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Smart picker"))+"\n\t\t\t\t\t")]):t._e(),t._v(" "),t.isScheduledSendingDisabled?t._e():e("ActionButton",{attrs:{"close-after-click":!1},on:{click:function(e){t.isMoreActionsOpen=!0}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("SendClock",{attrs:{size:20,title:t.t("mail","Send later")}})]},proxy:!0}],null,!1,1769650344)},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Send later"))+"\n\t\t\t\t\t")]),t._v(" "),!t.encrypt&&t.editorPlainText?e("ActionButton",{on:{click:function(e){return t.setEditorModeHtml()}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconHtml",{attrs:{size:20}})]},proxy:!0}],null,!1,811545534)},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Enable formatting"))+"\n\t\t\t\t\t")]):t._e(),t._v(" "),t.encrypt||t.editorPlainText?t._e():e("ActionButton",{on:{click:function(e){return t.setEditorModeText()}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconClose",{attrs:{size:20}})]},proxy:!0}],null,!1,2888946197)},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Disable formatting"))+"\n\t\t\t\t\t")]),t._v(" "),e("ActionCheckbox",{attrs:{checked:t.requestMdnVal},on:{check:function(e){t.requestMdnVal=!0},uncheck:function(e){t.requestMdnVal=!1}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Request a read receipt"))+"\n\t\t\t\t\t")]),t._v(" "),t.smimeCertificateForCurrentAlias?e("ActionCheckbox",{attrs:{checked:t.wantsSmimeSign},on:{check:function(e){t.wantsSmimeSign=!0},uncheck:function(e){t.wantsSmimeSign=!1}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Sign message with S/MIME"))+"\n\t\t\t\t\t")]):t._e(),t._v(" "),t.smimeCertificateForCurrentAlias?e("ActionCheckbox",{attrs:{checked:t.wantsSmimeEncrypt,disabled:t.encrypt},on:{check:function(e){t.wantsSmimeEncrypt=!0},uncheck:function(e){t.wantsSmimeEncrypt=!1}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Encrypt message with S/MIME"))+"\n\t\t\t\t\t")]):t._e(),t._v(" "),t.mailvelope.available?e("ActionCheckbox",{attrs:{checked:t.encrypt,disabled:t.wantsSmimeEncrypt},on:{change:function(e){t.isActionsOpen=!1},check:function(e){t.encrypt=!0},uncheck:function(e){t.encrypt=!1}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Encrypt message with Mailvelope"))+"\n\t\t\t\t\t")]):t._e()],t._v(" "),t.isMoreActionsOpen?[e("ActionButton",{attrs:{"close-after-click":!1},on:{click:function(e){t.isMoreActionsOpen=!1}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ChevronLeft",{attrs:{title:t.t("mail","Send later"),size:20}}),t._v("\n\t\t\t\t\t\t\t"+t._s(t.t("mail","Send later"))+"\n\t\t\t\t\t\t")]},proxy:!0}],null,!1,2922837455)}),t._v(" "),e("ActionRadio",{staticClass:"send-action-radio",attrs:{value:void 0,name:"sendLater",checked:!t.sendAtVal},on:{change:function(e){return t.onChangeSendLater(void 0)}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Send now"))+"\n\t\t\t\t\t")]),t._v(" "),e("ActionRadio",{staticClass:"send-action-radio send-action-radio--multiline",attrs:{value:t.dateTomorrowMorning,name:"sendLater",checked:t.isSendAtTomorrowMorning},on:{change:function(e){return t.onChangeSendLater(t.dateTomorrowMorning)}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Tomorrow morning"))+" - "+t._s(t.convertToLocalDate(t.dateTomorrowMorning))+"\n\t\t\t\t\t")]),t._v(" "),e("ActionRadio",{staticClass:"send-action-radio send-action-radio--multiline",attrs:{value:t.dateTomorrowAfternoon,name:"sendLater",checked:t.isSendAtTomorrowAfternoon},on:{change:function(e){return t.onChangeSendLater(t.dateTomorrowAfternoon)}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Tomorrow afternoon"))+" - "+t._s(t.convertToLocalDate(t.dateTomorrowAfternoon))+"\n\t\t\t\t\t")]),t._v(" "),e("ActionRadio",{staticClass:"send-action-radio send-action-radio--multiline",attrs:{value:t.dateMondayMorning,name:"sendLater",checked:t.isSendAtMondayMorning},on:{change:function(e){return t.onChangeSendLater(t.dateMondayMorning)}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Monday morning"))+" - "+t._s(t.convertToLocalDate(t.dateMondayMorning))+"\n\t\t\t\t\t")]),t._v(" "),e("ActionRadio",{staticClass:"send-action-radio",attrs:{name:"sendLater",checked:t.isSendAtCustom,value:t.customSendTime},on:{change:function(e){return t.onChangeSendLater(t.customSendTime)}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Custom date and time"))+"\n\t\t\t\t\t")]),t._v(" "),e("ActionInput",{attrs:{"is-native-picker":!0,min:t.dateToday,type:"datetime-local","first-day-of-week":t.firstDayDatetimePicker,use12h:t.showAmPm,formatter:t.formatter,format:"YYYY-MM-DD HH:mm",icon:"","minute-step":5},on:{change:function(e){return t.onChangeSendLater(t.customSendTime)}},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Enter a date"))+"\n\t\t\t\t\t")])]:t._e()],2),t._v(" "),e("ButtonVue",{attrs:{disabled:!t.canSend,"native-type":"submit",type:"primary","aria-label":t.submitButtonTitle},on:{click:t.onSend},scopedSlots:t._u([{key:"icon",fn:function(){return[e("Send",{attrs:{title:t.submitButtonTitle,size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.submitButtonTitle)+"\n\t\t\t")])],1)])],1)}),[],!1,null,"375dc1a6",null),fe=he.exports,me=r(1929),Ae=r(90941),ve=r(67727),ge=r(58511),ye=r(65925),Ce=r(72804);function be(t){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},be(t)}function we(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return xe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function xe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _e(){_e=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),s=new k(o||[]);return r(a,"_invoke",{value:b(t,n,s)}),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function h(){}function f(){}var m={};c(m,i,(function(){return this}));var A=Object.getPrototypeOf,v=A&&A(A(S([])));v&&v!==e&&n.call(v,i)&&(m=v);var g=f.prototype=p.prototype=Object.create(m);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function o(r,i,a,s){var c=u(t[r],t,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==be(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,s)}))}s(c.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=u(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=f,r(g,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(C.prototype),c(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function ke(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Se(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ke(i,r,o,a,s,"next",t)}function s(t){ke(i,r,o,a,s,"throw",t)}a(void 0)}))}}function Le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ee(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Le(Object(n),!0).forEach((function(e){De(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function De(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==be(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===be(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ie={name:"NewMessageModal",components:{ButtonVue:o.P2,Composer:fe,EmptyContent:o.SL,Loading:ge.Z,Modal:o.Jc,NcActions:o.O3,NcActionButton:o.Js,MinimizeIcon:ye.Z},data:function(){return{toolbarElements:void 0,original:void 0,draftsPromise:Promise.resolve(),attachmentsPromise:Promise.resolve(),canSaveDraft:!0,savingDraft:!1,draftSaved:!1,uploadingAttachments:!1,sending:!1,error:void 0,warning:void 0,modalFirstOpen:!0,cookedComposerData:void 0,changed:!1}},computed:Ee(Ee({},(0,Qt.Se)(["showMessageComposer"])),{},{modalTitle:function(){return"outbox"===this.composerMessage.type?(0,a.Iu)("mail","Edit message"):void 0!==this.composerData.draftId?(0,a.Iu)("mail","Draft"):this.composerData.replyTo?(0,a.Iu)("mail","Reply"):this.composerData.forwardFrom?(0,a.Iu)("mail","Forward"):(0,a.Iu)("mail","New message")},composerMessage:function(){return this.$store.getters.composerMessage},composerData:function(){var t,e;return null!==(t=null===(e=this.$store.getters.composerMessage)||void 0===e?void 0:e.data)&&void 0!==t?t:{}},forwardedMessages:function(){var t,e,n;return null!==(t=null===(e=this.composerMessage)||void 0===e||null===(n=e.options)||void 0===n?void 0:n.forwardedMessages)&&void 0!==t?t:[]}}),created:function(){var t,e=null===(t=this.composerData)||void 0===t?void 0:t.id;e&&(this.draftsPromise=Promise.resolve(e))},mounted:function(){var t=this;return Se(_e().mark((function e(){return _e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$nextTick();case 2:t.updateCookedComposerData();case 3:case"end":return e.stop()}}),e)})))()},methods:{handleShow:function(t){this.toolbarElements=[t]},toHtml:c.vb,plain:c.Oh,onDraft:function(t){var e=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).showToast,r=void 0!==n&&n;return this.composerMessage?(this.changed=!0,this.draftsPromise=this.draftsPromise.then(function(){var n=Se(_e().mark((function n(o){var c,l,u,d;return _e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.savingDraft=!0,e.draftSaved=!1,n.prev=2,l=e.getDataForServer(t,!0),o){n.next=17;break}return n.next=7,(0,Ce.DO)(l);case 7:return u=n.sent,d=u.id,l.id=d,n.next=12,e.$store.dispatch("patchComposerData",{id:d,draftId:l.draftId});case 12:e.canSaveDraft=!0,e.draftSaved=!0,c=d,n.next=23;break;case 17:return l.id=o,n.next=20,(0,Ce.XD)(l);case 20:e.canSaveDraft=!0,e.draftSaved=!0,c=o;case 23:if(e.$store.commit("setComposerMessageSaved",!0),r&&("outbox"===e.composerMessage.type?(0,i.s$)((0,a.Iu)("mail","Message saved")):(0,i.s$)((0,a.Iu)("mail","Draft saved"))),void 0===c){n.next=27;break}return n.abrupt("return",c);case 27:n.next=35;break;case 29:n.prev=29,n.t0=n.catch(2),s.Z.error("Could not save draft",{error:n.t0}),e.canSaveDraft=!1,e.$store.commit("setComposerIndicatorDisabled",!1),r&&("outbox"===e.composerMessage.type?(0,i.x2)((0,a.Iu)("mail","Failed to save message")):(0,i.x2)((0,a.Iu)("mail","Failed to save draft")));case 35:return n.prev=35,e.savingDraft=!1,n.finish(35);case 38:case"end":return n.stop()}}),n,null,[[2,29,35,38]])})));return function(t){return n.apply(this,arguments)}}()),this.draftsPromise):(s.Z.info("Ignoring draft because there is no message anymore",{data:t}),this.draftsPromise)},getDataForServer:function(t){var e;return Ee(Ee({},t),{},{id:t.id,accountId:t.accountId,body:t.isHtml?t.body.value:(0,c.UK)(t.body).value,editorBody:t.body.value,to:t.to,cc:t.cc,bcc:t.bcc,attachments:t.attachments,aliasId:t.aliasId,inReplyToMessageId:t.inReplyToMessageId,sendAt:t.sendAt,draftId:null===(e=this.composerData)||void 0===e?void 0:e.draftId})},onAttachmentUploading:function(t,e){var n=this;this.attachmentsPromise=this.attachmentsPromise.then(t).then((function(){return n.onDraft(e)})).then((function(){return s.Z.debug("attachments uploaded")})).catch((function(t){return s.Z.error("could not upload attachments",{error:t})}))},onSend:function(t){var e=this;return Se(_e().mark((function n(){var r,o,i,c,l,u,d,p,h;return _e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s.Z.debug("sending message",{data:t}),n.next=3,e.attachmentsPromise;case 3:e.uploadingAttachments=!1,e.sending=!0,n.prev=5,r=(new Date).getTime(),o=we(t.attachments);try{for(o.s();!(i=o.n()).done;)(c=i.value).type||(c.type="local")}catch(t){o.e(t)}finally{o.f()}return n.t0=e,n.t1=Ee,n.t2=Ee({},t),n.t3={},n.next=15,e.draftsPromise;case 15:if(n.t4=n.sent,n.t5=t.sendAt?t.sendAt:Math.floor((r+Jt.X1)/1e3),n.t6={id:n.t4,sendAt:n.t5},n.t7=(0,n.t1)(n.t2,n.t3,n.t6),(l=n.t0.getDataForServer.call(n.t0,n.t7)).sendAt<Math.floor((r+Jt.X1)/1e3)&&(l.sendAt=Math.floor((r+Jt.X1)/1e3)),e.composerData.id){n.next=31;break}return n.next=24,(0,Ce.DO)(l);case 24:return u=n.sent,d=u.id,l.id=d,n.next=29,e.$store.dispatch("outbox/enqueueFromDraft",{draftMessage:l,id:d});case 29:n.next=42;break;case 31:if(0!==e.composerData.type){n.next=37;break}return l.id=e.composerData.id,n.next=35,e.$store.dispatch("outbox/updateMessage",{message:l,id:e.composerData.id});case 35:n.next=42;break;case 37:return n.next=39,(0,Ce.XD)(l);case 39:return l.id=e.composerData.id,n.next=42,e.$store.dispatch("outbox/enqueueFromDraft",{draftMessage:l,id:e.composerData.id});case 42:return(!t.sendAt||t.sendAt<Math.floor((r+Jt.X1)/1e3))&&e.$store.dispatch("outbox/sendMessageWithUndo",{id:l.id}),l.id&&e.$store.commit("removeMessage",{id:l.id}),n.next=46,e.$store.dispatch("stopComposerSession");case 46:e.$emit("close"),n.next=55;break;case 49:return n.prev=49,n.t8=n.catch(5),s.Z.error("could not send message",{error:n.t8}),n.next=54,(0,me.d)(n.t8,(De(p={},Ae.Z.getName(),(function(){return(0,a.Iu)("mail","No sent mailbox configured. Please pick one in the account settings.")})),De(p,ve.Z.getName(),(function(){return(0,a.Iu)("mail","You are trying to send to many recipients in To and/or Cc. Consider using Bcc to hide recipient addresses.")})),De(p,"default",(function(t){if(t&&t.toString)return t.toString()})),p));case 54:e.error=n.sent;case 55:return n.prev=55,e.sending=!1,n.finish(55);case 58:(h=e.$store.getters.getAccount(t.accountId))&&parseInt(e.$route.params.mailboxId,10)===h.sentMailboxId&&setTimeout((function(){e.$store.dispatch("syncEnvelopes",{mailboxId:h.sentMailboxId,query:"",init:!1})}),500);case 60:case"end":return n.stop()}}),n,null,[[5,49,55,58]])})))()},onForceSend:function(){var t=this;return Se(_e().mark((function e(){return _e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onSend(null,!0);case 2:case"end":return e.stop()}}),e)})))()},recipientToRfc822:function(t){return t.email===t.label||""===t.label||0===t.email.search(/^[a-zA-Z]+:/)?t.email:'"'.concat(t.label,'" <').concat(t.email,">")},discardDraft:function(){var t=this;return Se(_e().mark((function e(){var n,r;return _e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.draftsPromise;case 2:return n=e.sent,(r="outbox"===t.composerMessage.type)&&(n=t.composerMessage.data.id),e.next=7,t.$store.dispatch("stopComposerSession");case 7:if(e.prev=7,!r){e.next=13;break}return e.next=11,t.$store.dispatch("outbox/deleteMessage",{id:n});case 11:e.next=14;break;case 13:(0,Ce.R5)(n);case 14:(0,i.s$)((0,a.Iu)("mail","Message discarded")),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(7),s.Z.error("Could not discard draft",{error:e.t0}),(0,i.x2)((0,a.Iu)("mail","Could not discard message"));case 21:case"end":return e.stop()}}),e,null,[[7,17]])})))()},convertEditorBody:function(t){return t.editorBody?t.editorBody:t.body?(0,c.vb)(t.body).value:""},updateCookedComposerData:function(){this.$refs.composer&&(this.cookedComposerData=this.$refs.composer.getMessageData())},patchComposerData:function(t){var e=this;return Se(_e().mark((function n(){return _e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.changed=!0,e.updateCookedComposerData(),n.next=4,e.$store.dispatch("patchComposerData",t);case 4:case"end":return n.stop()}}),n)})))()},onMinimize:function(){var t=this;return Se(_e().mark((function e(){return _e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.modalFirstOpen=!1,e.next=3,t.$store.dispatch("closeMessageComposer");case 3:if(t.$store.getters.composerMessageIsSaved||!t.changed){e.next=6;break}return e.next=6,t.onDraft(t.cookedComposerData,{showToast:!0});case 6:case"end":return e.stop()}}),e)})))()},onClose:function(){var t=this;return Se(_e().mark((function e(){return _e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$store.commit("setComposerIndicatorDisabled",!0),e.next=3,t.onMinimize();case 3:if(!t.canSaveDraft||!(t.changed&&t.draftSaved||!t.changed)){e.next=7;break}return s.Z.debug("Closing composer session due to close button click"),e.next=7,t.$store.dispatch("stopComposerSession",{restoreOriginalSendAt:!0,moveToImap:t.changed,id:t.composerData.id});case 7:case"end":return e.stop()}}),e)})))()}}},Be=Ie,Me=r(25209),Te={};Te.styleTagTransform=ot(),Te.setAttributes=tt(),Te.insert=X().bind(null,"head"),Te.domAPI=K(),Te.insertStyleElement=nt(),W()(Me.Z,Te),Me.Z&&Me.Z.locals&&Me.Z.locals;var Oe=(0,st.Z)(Be,(function(){var t=this,e=t._self._c;return t.showMessageComposer?e("Modal",{attrs:{size:"normal",title:t.modalTitle,"additional-trap-elements":t.toolbarElements},on:{close:function(e){"click"===e.type?t.onClose():t.onMinimize()}}},[t.error?e("EmptyContent",{staticClass:"centered-content",attrs:{title:t.t("mail","Error sending your message"),role:"alert"},scopedSlots:t._u([{key:"action",fn:function(){return[e("ButtonVue",{attrs:{type:"tertiary","aria-label":t.t("mail","Go back")},on:{click:function(e){t.error=void 0}}},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Go back"))+"\n\t\t\t")]),t._v(" "),e("ButtonVue",{attrs:{type:"tertiary","aria-label":t.t("mail","Retry")},on:{click:t.onSend}},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Retry"))+"\n\t\t\t")])]},proxy:!0}],null,!1,1765987980)},[e("p",[t._v(t._s(t.error))])]):t.uploadingAttachments?e("Loading",{attrs:{hint:t.t("mail","Uploading attachments "),role:"alert"}}):t.sending?e("Loading",{attrs:{hint:t.t("mail","Sending "),role:"alert"}}):t.warning?e("EmptyContent",{attrs:{title:t.t("mail","Warning sending your message"),role:"alert"}},[e("p",[t._v(t._s(t.warning))]),t._v(" "),e("ButtonVue",{attrs:{type:"tertiary","aria-label":t.t("mail","Go back")},on:{click:function(e){t.warning=void 0}}},[t._v("\n\t\t\t"+t._s(t.t("mail","Go back"))+"\n\t\t")]),t._v(" "),e("ButtonVue",{attrs:{type:"tertiary","aria-label":t.t("mail","Send anyway")},on:{click:t.onForceSend}},[t._v("\n\t\t\t"+t._s(t.t("mail","Send anyway"))+"\n\t\t")])],1):[e("NcActions",{staticClass:"minimize-button"},[e("NcActionButton",{attrs:{"aria-label":t.t("mail","Minimize composer")},on:{click:t.onMinimize},scopedSlots:t._u([{key:"icon",fn:function(){return[e("MinimizeIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,1222194427)})],1),t._v(" "),e("Composer",{ref:"composer",attrs:{"from-account":t.composerData.accountId,"from-alias":t.composerData.aliasId,to:t.composerData.to,cc:t.composerData.cc,bcc:t.composerData.bcc,subject:t.composerData.subject,"attachments-data":t.composerData.attachments,body:t.composerData.body,"editor-body":t.convertEditorBody(t.composerData),"in-reply-to-message-id":t.composerData.inReplyToMessageId,"reply-to":t.composerData.replyTo,"forward-from":t.composerData.forwardFrom,"send-at":1e3*t.composerData.sendAt,"forwarded-messages":t.forwardedMessages,"can-save-draft":t.canSaveDraft,"saving-draft":t.savingDraft,"draft-saved":t.draftSaved,"smime-sign":t.composerData.smimeSign,"smime-encrypt":t.composerData.smimeEncrypt,"is-first-open":t.modalFirstOpen,"request-mdn":t.composerData.requestMdn},on:{"update:from-account":function(e){return t.patchComposerData({accountId:e})},"update:from-alias":function(e){return t.patchComposerData({aliasId:e})},"update:to":function(e){return t.patchComposerData({to:e})},"update:cc":function(e){return t.patchComposerData({cc:e})},"update:bcc":function(e){return t.patchComposerData({bcc:e})},"update:subject":function(e){return t.patchComposerData({subject:e})},"update:attachments-data":function(e){return t.patchComposerData({attachments:e})},"update:editor-body":function(e){return t.patchComposerData({editorBody:e})},"update:send-at":function(e){return t.patchComposerData({sendAt:e/1e3})},"update:smime-sign":function(e){return t.patchComposerData({smimeSign:e})},"update:smime-encrypt":function(e){return t.patchComposerData({smimeSign:e})},"update:request-mdn":function(e){return t.patchComposerData({requestMdn:e})},draft:t.onDraft,"discard-draft":t.discardDraft,"upload-attachment":t.onAttachmentUploading,send:t.onSend,"show-toolbar":t.handleShow}})]],2):t._e()}),[],!1,null,"44e14e2b",null).exports}}]);
//# sourceMappingURL=mail.new-message-modal.c7dea9b74ae117b666c7.js.map